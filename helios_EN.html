<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Helios</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* ========== Îã§ÌÅ¨Î™®Îìú Í∏∞Î≥∏ ========== */
    body.dark-mode { background-color:#121212; color:#f0f0f0; }
    .dark-mode .border { border-color:#444 !important; }
    .dark-mode .bg-white { background-color:#2c2c2c !important; color:#f0f0f0 !important; }
    .dark-mode .bg-gray-100 { background-color:#1e1e1e !important; }
    .dark-mode .text-gray-800,
    .dark-mode .text-gray-700,
    .dark-mode .text-gray-600 { color:#dddddd !important; }
    .dark-mode .text-blue-700 { color:#66b0ff !important; }
    .dark-mode .text-blue-600 { color:#80caff !important; }
    .dark-mode .text-orange-500 { color:#ffa94d !important; }
    .dark-mode .text-green-600 { color:#79e68c !important; }
    .dark-mode .text-red-500 { color:#ff8080 !important; }
    .dark-mode .text-gray-500 { color:#aaa !important; }
    .dark-mode table { background-color:#2c2c2c; color:#f0f0f0; }
    .dark-mode th, .dark-mode td { border-color:#444 !important; }
    .dark-mode thead th { color:#000 !important; }
    .dark-mode summary { background-color:#333 !important; color:#fff !important; }
    .dark-mode ul li { color:#ddd; }
    .dark-mode select option { color:#000 !important; }
    .dark-mode select { color:#000 !important; }
    .dark-mode input { color:#000 !important; }

    /* ========== experts Ïä§ÌÉÄÏùº Ïπ¥Îìú ========== */
    .exp-card{
      border:1px solid rgba(0,0,0,.08);
      border-radius:16px;
      background:#fff;
      box-shadow:0 6px 18px rgba(15,23,42,.06);
      transition: box-shadow .2s ease;
    }
    .exp-card:hover{ box-shadow:0 10px 26px rgba(15,23,42,.12); }
    .exp-divider{ border-color:rgba(0,0,0,.08); }
    .muted{ font-size:12px; color:#6b7280; }

    /* Îã§ÌÅ¨Î™®Îìú Ïπ¥Îìú Î≥¥Ï†ï */
    body.dark-mode .exp-card{ background-color:#2c2c2c !important; border-color:#444 !important; }
    body.dark-mode .exp-divider{ border-color:#444 !important; }
    body.dark-mode .muted{ color:#b7b7b7 !important; }
    body.dark-mode .svs-score-label,
    body.dark-mode .svs-score-value {
      font-weight: 700;
      color: #16AC7A !important;
    }
  </style>

  <!-- ‚úÖ Îã§ÌÅ¨Î™®Îìú ÏÉÅÌÉú Ïú†ÏßÄ -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
      }
    });
  </script>
</head>
<body class="bg-gray-100 p-2 font-sans text-sm">
  <div class="max-w-[1500px] mx-auto bg-white p-3 rounded-xl shadow-md">
    <h1 class="text-2xl font-bold text-gray-800 mb-4">üß™ Heilos</h1>

    <div class="text-gray-600 mb-4 text-sm">
      <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 gap-4">
        <!-- Î≥ëÏ¢Ö ÏÑ†ÌÉù (Î≤ÑÌäº ÌÜ†Í∏Ä) -->
        <div>
          <div class="text-sm font-medium mb-1">Select Troop</div>          
          <div class="grid grid-cols-3 gap-2 mb-2">
            <button type="button"
                    class="w-full px-3 py-2 rounded-xl border font-semibold text-sm toggle-btn"
                    data-toggle="chkInf" data-group="troop" data-mode="single">
              Infantry
            </button>
            <button type="button"
                    class="w-full px-3 py-2 rounded-xl border font-semibold text-sm toggle-btn"
                    data-toggle="chkLan" data-group="troop" data-mode="single">
              Lancer
            </button>
            <button type="button"
                    class="w-full px-3 py-2 rounded-xl border font-semibold text-sm toggle-btn"
                    data-toggle="chkMask" data-group="troop" data-mode="single">
              Maskman
            </button>
            <!-- ‚úÖ Í∏∞Ï°¥ Î°úÏßÅ Í∑∏ÎåÄÎ°ú Ïì∞Í∏∞ ÏúÑÌïú Ï≤¥ÌÅ¨Î∞ïÏä§(Ïà®ÍπÄ) -->
            <input type="checkbox" id="chkInf" checked hidden>
            <input type="checkbox" id="chkLan" hidden>
            <input type="checkbox" id="chkMask" hidden>
          </div>
        </div>        
        <!-- Î∂ÄÏßëÌñâÍ¥Ä -->
        <div>
          <div class="text-sm font-medium mb-1">Vice President</div>
          <div class="flex flex-wrap gap-2">
            <button type="button"
                    class="w-[105px] px-3 py-2 rounded-xl border font-semibold text-sm toggle-btn"
                    data-toggle="chkVP10" data-group="vp" data-mode="single">
              10%
            </button>
            <button type="button"
                    class="w-[105px] px-3 py-2 rounded-xl border font-semibold text-sm toggle-btn"
                    data-toggle="chkVP15" data-group="vp" data-mode="single">
              15%
            </button>
          </div>
          <input type="checkbox" id="chkVP10" hidden>
          <input type="checkbox" id="chkVP15" hidden>
        </div>
        <div>
          <label class="block text-sm mb-1">Valeria</label>
          <select id="chkExpertV" class="w-full rounded-md border px-2 py-2">
            <option>None</option>
            <option>Lv.1</option><option>Lv.2</option><option>Lv.3</option><option>Lv.4</option><option>Lv.5</option>
            <option>Lv.6</option><option>Lv.7</option><option>Lv.8</option><option>Lv.9</option><option>Lv.10</option>
          </select>
        </div>
        <!--ÏÑúÎ≤ÑÎ≤ÑÌîÑ-->
        <div>
          <div class="text-sm font-medium mb-1">Research Advancement (10%)</div>
          <div class="flex flex-wrap gap-2">
            <button type="button"
                    class="w-full px-3 py-2 rounded-xl border font-semibold text-sm toggle-btn"
                    data-toggle="chkServerBuff" data-group="server" data-mode="single">
              Active
            </button>
          </div>
          <input type="checkbox" id="chkServerBuff" hidden>
        </div>        
        <!-- Ïó∞Íµ¨ÏÜçÎèÑ -->
        <div>
          <label for="speedPercent" class="block text-sm mb-1">Research Speed (%)</label>
          <input type="number" id="speedPercent" class="border rounded p-2 text-sm w-24 text-right" placeholder="0" min="0" />
        </div>
      </div>
    </div>

    <!-- Ïπ¥Îìú Í∑∏Î¶¨Îìú -->
    <div id="researchGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-2 mb-4"></div>
  
    <!-- ‚úÖ ÏµúÌïòÎã® Ï¥ùÌï©Í≥Ñ Ìå®ÎÑê -->
    <div id="summaryPanel" class="mt-4">      
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-3">
        <!-- Ï¥ùÌï© -->
        <div class="rounded-xl border border-black/10 p-3">
          <div class="font-semibold mb-2">Total</div>
          <div class="flex justify-between text-[13px]">
            <div class="flex items-center gap-2 text-gray-600">
              <img src="images/icon_FCShard.webp" class="w-6 h-6" alt="Î∂àÏàòÏ°∞Í∞Å">
              <span>FC Shard</span>
            </div>
            <span id="sum-Í∞ÄÎ£®">0</span>
          </div>
          <div class="font-semibold mb-2"></div>
          <div class="flex justify-between text-[13px]">
            <div class="flex items-center gap-2 text-gray-600">
              <img src="images/icon_Steel.webp" class="w-6 h-6" alt="Ï≤†Í∞ïÏû¨">
              <span>Steel</span>
            </div>
            <span id="sum-Ï≤†Í∞ïÏû¨">0</span>
          </div>           
          <div class="font-semibold mb-2"></div>
          <div class="flex justify-between text-[13px]"><span class="text-gray-600">Required Time</span><span id="sum-ÏãúÍ∞Ñ">0min</span></div>
        </div>

        <!-- Î≥¥Ïú†Îüâ -->          
        <div class="rounded-xl border border-black/10 p-3">
          <div class="font-semibold mb-2">Owned</div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <div>
              <label for="owned-Í∞ÄÎ£®" class="block text-[13px] text-gray-600 mb-1">FC Shard</label>
              <input type="number" id="owned-Í∞ÄÎ£®" class="w-full border rounded-lg px-3 py-2 text-sm" placeholder="0" min="0" inputmode="numeric" />
            </div>
            <div>
              <label for="owned-Ï≤†Í∞ïÏû¨" class="block text-[13px] text-gray-600 mb-1">Steel</label>
              <input type="number" id="owned-Ï≤†Í∞ïÏû¨" class="w-full border rounded-lg px-3 py-2 text-sm" placeholder="0" min="0" inputmode="numeric" />
            </div>
          </div>
        </div>

        <!-- Í≥ºÎ∂ÄÏ°± -->
        <div class="rounded-xl border border-black/10 p-3">
          <div class="font-semibold mb-2">Surplus</div>
          <div class="flex justify-between text-[13px]">
            <div class="flex items-center gap-2 text-gray-600">
              <img src="images/icon_FCShard.webp" class="w-6 h-6" alt="Î∂àÏàòÏ°∞Í∞Å">
              <span>FC Shard</span>
            </div>
            <span id="def-Í∞ÄÎ£®">0</span>
          </div>
          <div class="font-semibold mb-2"></div>
          <div class="flex justify-between text-[13px]">
            <div class="flex items-center gap-2 text-gray-600">
              <img src="images/icon_Steel.webp" class="w-6 h-6" alt="Ï≤†Í∞ïÏû¨">
              <span>Steel</span>
            </div>
            <span id="def-Ï≤†Í∞ïÏû¨">0</span>
          </div>
        </div>
      </div>
    </div>
    <div class="flex justify-end mt-2">
      <button id="btn-calc-total" class="w-full px-4 py-2 rounded-lg bg-blue-600 text-white text-sm hover:bg-blue-700">Total Calc</button>
    </div>  
  </div>

  <script>
    /* ========== Îç∞Ïù¥ÌÑ∞ ========== */
    const researchData = {
      "I": [
        { level: 1, Í∞ÄÎ£®: 16, Ï≤†Í∞ïÏû¨: 5000, ÏãúÍ∞Ñ: "0d 08:00:00" },
        { level: 2, Í∞ÄÎ£®: 25, Ï≤†Í∞ïÏû¨: 8000, ÏãúÍ∞Ñ: "0d 12:48:00" },
        { level: 3, Í∞ÄÎ£®: 41, Ï≤†Í∞ïÏû¨: 13000, ÏãúÍ∞Ñ: "0d 20:48:00" },
        { level: 4, Í∞ÄÎ£®: 68, Ï≤†Í∞ïÏû¨: 21000, ÏãúÍ∞Ñ: "1d 10:24:00" },
        { level: 5, Í∞ÄÎ£®: 102, Ï≤†Í∞ïÏû¨: 33000, ÏãúÍ∞Ñ: "2d 06:00:00" },
      ],
      "II-A": [
        { level: 1, Í∞ÄÎ£®: 40, Ï≤†Í∞ïÏû¨: 10000, ÏãúÍ∞Ñ: "0d 20:00:00" },
        { level: 2, Í∞ÄÎ£®: 56, Ï≤†Í∞ïÏû¨: 14000, ÏãúÍ∞Ñ: "1d 04:00:00" },
        { level: 3, Í∞ÄÎ£®: 74, Ï≤†Í∞ïÏû¨: 18000, ÏãúÍ∞Ñ: "1d 13:00:00" },
        { level: 4, Í∞ÄÎ£®: 102, Ï≤†Í∞ïÏû¨: 25000, ÏãúÍ∞Ñ: "2d 03:00:00" },
        { level: 5, Í∞ÄÎ£®: 136, Ï≤†Í∞ïÏû¨: 24000, ÏãúÍ∞Ñ: "2d 20:00:00" },
        { level: 6, Í∞ÄÎ£®: 184, Ï≤†Í∞ïÏû¨: 46000, ÏãúÍ∞Ñ: "3d 20:00:00" },
        { level: 7, Í∞ÄÎ£®: 248, Ï≤†Í∞ïÏû¨: 62000, ÏãúÍ∞Ñ: "5d 04:00:00" },
        { level: 8, Í∞ÄÎ£®: 334, Ï≤†Í∞ïÏû¨: 83000, ÏãúÍ∞Ñ: "6d 23:00:00" },
      ],
      "II-B": [
        { level: 1, Í∞ÄÎ£®: 40, Ï≤†Í∞ïÏû¨: 10000, ÏãúÍ∞Ñ: "0d 20:00:00" },
        { level: 2, Í∞ÄÎ£®: 56, Ï≤†Í∞ïÏû¨: 14000, ÏãúÍ∞Ñ: "1d 04:00:00" },
        { level: 3, Í∞ÄÎ£®: 74, Ï≤†Í∞ïÏû¨: 18000, ÏãúÍ∞Ñ: "1d 13:00:00" },
        { level: 4, Í∞ÄÎ£®: 102, Ï≤†Í∞ïÏû¨: 25000, ÏãúÍ∞Ñ: "2d 03:00:00" },
        { level: 5, Í∞ÄÎ£®: 136, Ï≤†Í∞ïÏû¨: 24000, ÏãúÍ∞Ñ: "2d 20:00:00" },
        { level: 6, Í∞ÄÎ£®: 184, Ï≤†Í∞ïÏû¨: 46000, ÏãúÍ∞Ñ: "3d 20:00:00" },
        { level: 7, Í∞ÄÎ£®: 248, Ï≤†Í∞ïÏû¨: 62000, ÏãúÍ∞Ñ: "5d 04:00:00" },
        { level: 8, Í∞ÄÎ£®: 334, Ï≤†Í∞ïÏû¨: 83000, ÏãúÍ∞Ñ: "6d 23:00:00" },
      ],
      "III": [
        { level: 1, Í∞ÄÎ£®: 83, Ï≤†Í∞ïÏû¨: 23000, ÏãúÍ∞Ñ: "1d 05:20:17" },
        { level: 2, Í∞ÄÎ£®: 102, Ï≤†Í∞ïÏû¨: 28000, ÏãúÍ∞Ñ: "1d 12:05:08" },
        { level: 3, Í∞ÄÎ£®: 125, Ï≤†Í∞ïÏû¨: 34000, ÏãúÍ∞Ñ: "1d 20:00:25" },
        { level: 4, Í∞ÄÎ£®: 150, Ï≤†Í∞ïÏû¨: 41000, ÏãúÍ∞Ñ: "2d 04:48:30" },
        { level: 5, Í∞ÄÎ£®: 184, Ï≤†Í∞ïÏû¨: 51000, ÏãúÍ∞Ñ: "2d 16:32:37" },
        { level: 6, Í∞ÄÎ£®: 225, Ï≤†Í∞ïÏû¨: 62000, ÏãúÍ∞Ñ: "3d 07:12:45" },
        { level: 7, Í∞ÄÎ£®: 276, Ï≤†Í∞ïÏû¨: 76000, ÏãúÍ∞Ñ: "4d 00:58:56" },
        { level: 8, Í∞ÄÎ£®: 334, Ï≤†Í∞ïÏû¨: 93000, ÏãúÍ∞Ñ: "4d 21:21:08" },
        { level: 9, Í∞ÄÎ£®: 418, Ï≤†Í∞ïÏû¨: 110000, ÏãúÍ∞Ñ: "6d 02:41:25" },
        { level: 10, Í∞ÄÎ£®: 502, Ï≤†Í∞ïÏû¨: 130000, ÏãúÍ∞Ñ: "7d 08:01:42" },
        { level: 11, Í∞ÄÎ£®: 602, Ï≤†Í∞ïÏû¨: 160000, ÏãúÍ∞Ñ: "8d 19:14:02" },
        { level: 12, Í∞ÄÎ£®: 744, Ï≤†Í∞ïÏû¨: 200000, ÏãúÍ∞Ñ: "10d 21:06:31" },
      ],
      "IV-A": [
        { level: 1, Í∞ÄÎ£®: 54, Ï≤†Í∞ïÏû¨: 15000, ÏãúÍ∞Ñ: "0d 18:55:40" },
        { level: 2, Í∞ÄÎ£®: 66, Ï≤†Í∞ïÏû¨: 18000, ÏãúÍ∞Ñ: "0d 23:16:52" },
        { level: 3, Í∞ÄÎ£®: 81, Ï≤†Í∞ïÏû¨: 22000, ÏãúÍ∞Ñ: "1d 04:23:30" },
        { level: 4, Í∞ÄÎ£®: 97, Ï≤†Í∞ïÏû¨: 27000, ÏãúÍ∞Ñ: "1d 10:04:12" },
        { level: 5, Í∞ÄÎ£®: 118, Ï≤†Í∞ïÏû¨: 33000, ÏãúÍ∞Ñ: "1d 17:38:28" },
        { level: 6, Í∞ÄÎ£®: 145, Ï≤†Í∞ïÏû¨: 40000, ÏãúÍ∞Ñ: "2d 03:06:18" },
        { level: 7, Í∞ÄÎ£®: 178, Ï≤†Í∞ïÏû¨: 49000, ÏãúÍ∞Ñ: "2d 14:27:42" },
        { level: 8, Í∞ÄÎ£®: 216, Ï≤†Í∞ïÏû¨: 60000, ÏãúÍ∞Ñ: "3d 03:42:20" },
        { level: 9, Í∞ÄÎ£®: 270, Ï≤†Í∞ïÏû¨: 75000, ÏãúÍ∞Ñ: "3d 22:38:20" },
        { level: 10, Í∞ÄÎ£®: 324, Ï≤†Í∞ïÏû¨: 90000, ÏãúÍ∞Ñ: "4d 17:34:00" },
        { level: 11, Í∞ÄÎ£®: 388, Ï≤†Í∞ïÏû¨: 100000, ÏãúÍ∞Ñ: "5d 16:16:48" },
        { level: 12, Í∞ÄÎ£®: 480, Ï≤†Í∞ïÏû¨: 130000, ÏãúÍ∞Ñ: "7d 00:27:26" },
      ],
      "IV-B": [
        { level: 1, Í∞ÄÎ£®: 54, Ï≤†Í∞ïÏû¨: 15000, ÏãúÍ∞Ñ: "0d 18:55:40" },
        { level: 2, Í∞ÄÎ£®: 66, Ï≤†Í∞ïÏû¨: 18000, ÏãúÍ∞Ñ: "0d 23:16:52" },
        { level: 3, Í∞ÄÎ£®: 81, Ï≤†Í∞ïÏû¨: 22000, ÏãúÍ∞Ñ: "1d 04:23:30" },
        { level: 4, Í∞ÄÎ£®: 97, Ï≤†Í∞ïÏû¨: 27000, ÏãúÍ∞Ñ: "1d 10:04:12" },
        { level: 5, Í∞ÄÎ£®: 118, Ï≤†Í∞ïÏû¨: 33000, ÏãúÍ∞Ñ: "1d 17:38:28" },
        { level: 6, Í∞ÄÎ£®: 145, Ï≤†Í∞ïÏû¨: 40000, ÏãúÍ∞Ñ: "2d 03:06:18" },
        { level: 7, Í∞ÄÎ£®: 178, Ï≤†Í∞ïÏû¨: 49000, ÏãúÍ∞Ñ: "2d 14:27:42" },
        { level: 8, Í∞ÄÎ£®: 216, Ï≤†Í∞ïÏû¨: 60000, ÏãúÍ∞Ñ: "3d 03:42:20" },
        { level: 9, Í∞ÄÎ£®: 270, Ï≤†Í∞ïÏû¨: 75000, ÏãúÍ∞Ñ: "3d 22:38:20" },
        { level: 10, Í∞ÄÎ£®: 324, Ï≤†Í∞ïÏû¨: 90000, ÏãúÍ∞Ñ: "4d 17:34:00" },
        { level: 11, Í∞ÄÎ£®: 388, Ï≤†Í∞ïÏû¨: 100000, ÏãúÍ∞Ñ: "5d 16:16:48" },
        { level: 12, Í∞ÄÎ£®: 480, Ï≤†Í∞ïÏû¨: 130000, ÏãúÍ∞Ñ: "7d 00:27:26" },
      ],
      "V": [
        { level: 1, Í∞ÄÎ£®: 2236, Ï≤†Í∞ïÏû¨: 1000000, ÏãúÍ∞Ñ: "91d 08:15:00" },
      ],
      "Healing": [
        { level: 1, Í∞ÄÎ£®: 102, Ï≤†Í∞ïÏû¨: 30000, ÏãúÍ∞Ñ: "2d 02:00:00" },
        { level: 2, Í∞ÄÎ£®: 137, Ï≤†Í∞ïÏû¨: 40000, ÏãúÍ∞Ñ: "2d 19:30:00" },
        { level: 3, Í∞ÄÎ£®: 188, Ï≤†Í∞ïÏû¨: 55000, ÏãúÍ∞Ñ: "3d 20:30:00" },
        { level: 4, Í∞ÄÎ£®: 255, Ï≤†Í∞ïÏû¨: 75000, ÏãúÍ∞Ñ: "5d 05:00:00" },
        { level: 5, Í∞ÄÎ£®: 341, Ï≤†Í∞ïÏû¨: 100000, ÏãúÍ∞Ñ: "6d 23:30:00" },
        { level: 6, Í∞ÄÎ£®: 459, Ï≤†Í∞ïÏû¨: 130000, ÏãúÍ∞Ñ: "9d 09:00:00" },
        { level: 7, Í∞ÄÎ£®: 612, Ï≤†Í∞ïÏû¨: 180000, ÏãúÍ∞Ñ: "12d 12:00:00" },
        { level: 8, Í∞ÄÎ£®: 836, Ï≤†Í∞ïÏû¨: 240000, ÏãúÍ∞Ñ: "17d 02:00:00" },
        { level: 9, Í∞ÄÎ£®: 1122, Ï≤†Í∞ïÏû¨: 330000, ÏãúÍ∞Ñ: "22d 22:00:00" },
        { level: 10, Í∞ÄÎ£®: 1530, Ï≤†Í∞ïÏû¨: 450000, ÏãúÍ∞Ñ: "31d 06:00:00" },
      ],
      "Training": [
        { level: 1, Í∞ÄÎ£®: 102, Ï≤†Í∞ïÏû¨: 30000, ÏãúÍ∞Ñ: "2d 02:00:00" },
        { level: 2, Í∞ÄÎ£®: 137, Ï≤†Í∞ïÏû¨: 40000, ÏãúÍ∞Ñ: "2d 19:30:00" },
        { level: 3, Í∞ÄÎ£®: 188, Ï≤†Í∞ïÏû¨: 55000, ÏãúÍ∞Ñ: "3d 20:30:00" },
        { level: 4, Í∞ÄÎ£®: 255, Ï≤†Í∞ïÏû¨: 75000, ÏãúÍ∞Ñ: "5d 05:00:00" },
        { level: 5, Í∞ÄÎ£®: 341, Ï≤†Í∞ïÏû¨: 100000, ÏãúÍ∞Ñ: "6d 23:30:00" },
        { level: 6, Í∞ÄÎ£®: 459, Ï≤†Í∞ïÏû¨: 130000, ÏãúÍ∞Ñ: "9d 09:00:00" },
        { level: 7, Í∞ÄÎ£®: 612, Ï≤†Í∞ïÏû¨: 180000, ÏãúÍ∞Ñ: "12d 12:00:00" },
        { level: 8, Í∞ÄÎ£®: 836, Ï≤†Í∞ïÏû¨: 240000, ÏãúÍ∞Ñ: "17d 02:00:00" },
        { level: 9, Í∞ÄÎ£®: 1122, Ï≤†Í∞ïÏû¨: 330000, ÏãúÍ∞Ñ: "22d 22:00:00" },
        { level: 10, Í∞ÄÎ£®: 1530, Ï≤†Í∞ïÏû¨: 450000, ÏãúÍ∞Ñ: "31d 06:00:00" },
      ],
      "HealingTime": [
        { level: 1, Í∞ÄÎ£®: 51, Ï≤†Í∞ïÏû¨: 15000, ÏãúÍ∞Ñ: "1d 01:00:00" },
        { level: 2, Í∞ÄÎ£®: 68, Ï≤†Í∞ïÏû¨: 20000, ÏãúÍ∞Ñ: "1d 09:45:00" },
        { level: 3, Í∞ÄÎ£®: 94, Ï≤†Í∞ïÏû¨: 27000, ÏãúÍ∞Ñ: "1d 22:15:00" },
        { level: 4, Í∞ÄÎ£®: 127, Ï≤†Í∞ïÏû¨: 37000, ÏãúÍ∞Ñ: "2d 14:30:00" },
        { level: 5, Í∞ÄÎ£®: 170, Ï≤†Í∞ïÏû¨: 50000, ÏãúÍ∞Ñ: "3d 11:45:00" },
        { level: 6, Í∞ÄÎ£®: 229, Ï≤†Í∞ïÏû¨: 67000, ÏãúÍ∞Ñ: "4d 16:30:00" },
        { level: 7, Í∞ÄÎ£®: 306, Ï≤†Í∞ïÏû¨: 90000, ÏãúÍ∞Ñ: "6d 06:00:00" },
        { level: 8, Í∞ÄÎ£®: 418, Ï≤†Í∞ïÏû¨: 120000, ÏãúÍ∞Ñ: "8d 13:00:00" },
        { level: 9, Í∞ÄÎ£®: 561, Ï≤†Í∞ïÏû¨: 160000, ÏãúÍ∞Ñ: "11d 11:00:00" },
        { level: 10, Í∞ÄÎ£®: 765, Ï≤†Í∞ïÏû¨: 220000, ÏãúÍ∞Ñ: "15d 15:00:00" },
      ]
    };
    
    // ‚úÖ Î∞úÎ†àÎ¶¨ÏïÑ(SVS Ï†êÏàò Î≥¥ÎÑàÏä§)
    const EXPERT_BONUS = {
      "None":0,
      "Lv.1":0.02,"Lv.2":0.04,"Lv.3":0.06,"Lv.4":0.08,"Lv.5":0.10,
      "Lv.6":0.12,"Lv.7":0.14,"Lv.8":0.16,"Lv.9":0.18,"Lv.10":0.20
    };
    const EXPERT_DESC = {
      "Lv.1":  "+2%",
      "Lv.2":  "+4%",
      "Lv.3":  "+6%",
      "Lv.4":  "+8%",
      "Lv.5":  "+10%",
      "Lv.6":  "+12%",
      "Lv.7":  "+14%",
      "Lv.8":  "+16%",
      "Lv.9":  "+18%",
      "Lv.10": "+20%"
    };

    function getValeriaBonus(){
      const sel = document.getElementById("chkExpertV");
      if (!sel) return 0;
      const key = (sel.value || sel.options[sel.selectedIndex]?.text || "None").trim();
      return EXPERT_BONUS[key] ?? 0;
    }

    function getValeriaDesc(){
      const expertSel = document.getElementById("chkExpertV");
      const lv = expertSel.value;
      const text = EXPERT_DESC[lv]
        ? "SvS Ï†êÏàò " + EXPERT_DESC[lv]
        : "SvS Ï†êÏàò";

      document.querySelectorAll(".svs-score-label").forEach(el => {
        el.textContent = text;
      });
    }
    /* ========== ÏÉÅÌÉú & Ïú†Ìã∏ ========== */
    let researchList = [];

    function parseTimeToSeconds(timeStr) {
      const [d, hms] = timeStr.split(" ");
      const [h, m, s] = hms.split(":").map(Number);
      return (parseInt(d)||0)*86400 + h*3600 + m*60 + s;
    }
    function formatTime(sec) {
      const d = Math.floor(sec / 86400);
      sec %= 86400;
      const h = Math.floor(sec / 3600);
      sec %= 3600;
      const m = Math.floor(sec / 60);
      const s = sec % 60;
      return `${d}d ${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    }
    function createLevelOptions(max) {
      return Array.from({length:max+1}, (_,i)=>`<option value="${i}">${i}</option>`).join('');
    }
	  
    function updateResearchList() {
      const chkInf = document.getElementById("chkInf");
      const chkLan = document.getElementById("chkLan");
      const chkMask = document.getElementById("chkMask");

      researchList = Object.entries(researchData).map(([key, value]) => {
        let label = {
          "I": "Flame Squad",
          "II-A": "Flame Strike",
          "II-B" : "Flame Shield",
          "III" : "Flame Legion",
          "IV-A" : "Flame Tomahawk",
          "IV-B" : "Flame Protection",
          "V" : "Helios Infantry",
          "Healing" : "Healing",
          "Training" : "Trainning",
          "HealingTime" : "First Aid",
        }[key];

        switch (key) {
          case "II-A":
            if (chkInf.checked) label = "Flame Strike";
            else if (chkLan.checked) label = "Blazing Charge";
            else if (chkMask.checked) label = "Crystal Vision";
            break;
          case "II-B":
            if (chkInf.checked) label = "Flame Shield";
            else if (chkLan.checked) label = "Blazing Armor";
            else if (chkMask.checked) label = "Crystal Armor";
            break;
          case "IV-A":
            if (chkInf.checked) label = "Flame Tomahawk";
            else if (chkLan.checked) label = "Blazing Lance";
            else if (chkMask.checked) label = "Crystal Arrow";
            break;
          case "IV-B":
            if (chkInf.checked) label = "Flame Protection";
            else if (chkLan.checked) label = "Blazing Protection";
            else if (chkMask.checked) label = "Crystal Protection";
            break;
          default:
            break;
        }
        return { key, label, max: Math.max(...value.map(v=>v.level)) };
      });
    }
	  
    function getTroopCode(){
      if (document.getElementById("chkInf")?.checked) return "inf";   // Î∞©Ìå®
      if (document.getElementById("chkLan")?.checked) return "lan";   // Ï∞Ω
      if (document.getElementById("chkMask")?.checked) return "marsk"; // Í∂Å
      return "inf";
    }
          
    function renderResearchCards() {
      const container = document.getElementById("researchGrid");
      container.className = "grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-4";
      container.innerHTML = "";

      const POS = {
        "I": {r:1,c:2},           // Î∂àÍΩÉÎ∂ÄÎåÄ
        "II-A": {r:2,c:1},        // Î∂àÍΩÉÍ≥µÍ≤©
        "II-B": {r:2,c:3},        // Î∂àÍΩÉÎ∞©Ìå®
        "III": {r:3,c:2},         // Î∂àÍΩÉÍµ∞Îã®
        "IV-A": {r:4,c:1},        // Î∂àÍΩÉÎèÑÎÅº
        "IV-B": {r:4,c:3},        // Î∂àÍΩÉÏàòÌò∏
        "V": {r:5,c:2},           // Ìó¨Î¶¨Ïò§Ïä§ Î≥ëÏÇ¨
        "Healing": {r:6,c:1},     // ÏπòÎ£åÏó∞Íµ¨
        "Training": {r:7,c:2},    // ÌõàÎ†®Ïó∞Íµ¨
        "HealingTime": {r:6,c:3}  // Íµ¨Í∏âÏó∞Íµ¨
      };

      researchList.forEach(item => {
        const wrap = document.createElement("div");
        wrap.className = "exp-card";
        if (POS[item.key]) {
          wrap.style.gridRowStart = POS[item.key].r;
          wrap.style.gridColumnStart = POS[item.key].c;
        }

        const chkId = `check-${item.key}`;
        const curId = `current-${item.key}`;
        const tgtId = `target-${item.key}`;

        const troop = getTroopCode();
        const imgSrc = `images/helios/${troop}/${troop}-${item.key}.webp`;
      
        wrap.innerHTML = `
          <div class="p-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
              <div class="flex gap-2">
                <!-- ‚úÖ Í≥µÌÜµ Ïπ¥Îìú Ïù¥ÎØ∏ÏßÄ -->
                <div class="shrink-0">
                  <div class="w-[84px] h-[84px]">
                    <img src="${imgSrc}"class="w-full h-full object-cover" alt="card-icon" loading="lazy" />
                  </div>
                </div>

                <div class="min-w-0">
                  <div class="flex items-center gap-2 mb-2">
                    <h3 class="text-[15px] font-semibold text-gray-800">${item.label}</h3>
                  </div>
                  <p class="muted mb-3">Level Range (Max Lv.${item.max})</p>

                  <!-- ‚úÖ ÌòÑÏû¨/Î™©Ìëú ÏÑ∏Î°ú Î∞∞Ïπò -->
                  <div class="flex flex-col gap-2">
                    <!-- ÌòÑÏû¨ -->
                    <div class="flex items-center gap-2">
                      <span class="text-[12px] text-gray-600 w-[42px]">Current</span>
                      <select id="${curId}"
                        class="border rounded-lg px-2 py-1 text-sm w-full min-w-[88px]">
                        ${createLevelOptions(item.max)}
                      </select>
                    </div>

                    <!-- Î™©Ìëú -->
                    <div class="flex items-center gap-2">
                      <span class="text-[12px] text-gray-600 w-[42px]">Target„ÄÄ</span>
                      <select id="${tgtId}"
                        class="border rounded-lg px-2 py-1 text-sm w-full min-w-[88px]">
                        ${createLevelOptions(item.max)}
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <div class="md:pl-4">
                <div class="font-semibold text-gray-800 mb-2">Sub Total</div>
                <div class="grid grid-cols-[1fr_auto] gap-x-3 text-[13px]">
                  <div class="flex items-center gap-2 text-gray-600">
                    <img src="images/icon_FCShard.webp" class="w-6 h-6" alt="Î∂àÏàòÏ°∞Í∞Å">
                    <span>FC Shard</span>
                  </div>
                  <div class="text-right tabular-nums" id="subtotal-dust-${item.key}">0</div>
                  <div class="flex items-center gap-2 text-gray-600">
                    <img src="images/icon_Steel.webp" class="w-6 h-6" alt="Ï≤†Í∞ïÏû¨">
                    <span>Steel</span>
                  </div>
                  <div class="text-right tabular-nums" id="subtotal-steel-${item.key}">0</div>
                  <div class="text-gray-600">Required Time</div>
                  <div class="text-right tabular-nums" id="subtotal-time-${item.key}">0</div>
                  <div class="col-span-2 border-t border-gray-200 mt-1"></div>
                  <div class="svs-score-label text-gray-600">SVS Score</div>
                  <div id="sub-Ï†êÏàò-${item.label}" class="svs-score-value text-right tabular-nums font-medium">0</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `;

        container.appendChild(wrap);

        // ÌòÑÏû¨ Î≥ÄÍ≤Ω Ïãú Î™©Ìëú ÏûêÎèô +1
        const curSel = wrap.querySelector(`#${curId}`);
        const tgtSel = wrap.querySelector(`#${tgtId}`);
        curSel.addEventListener("change", () => {
          let nextValue = parseInt(curSel.value) + 1;
          if (nextValue > item.max) nextValue = item.max;
          tgtSel.value = nextValue;
          scheduleCalc();
        });
        tgtSel.addEventListener("change", scheduleCalc);
      });
    }

    /* ========== ÏòµÏÖò ÌÜ†Í∏Ä ========== */
    function handleCheck(toggleId) {
      const chkInf = document.getElementById("chkInf");
      const chkLan = document.getElementById("chkLan");
      const chkMask = document.getElementById("chkMask");

      if (toggleId === "chkInf" && chkInf.checked) {
        chkLan.checked = false; chkMask.checked = false;
      } else if (toggleId === "chkLan" && chkLan.checked) {
        chkInf.checked = false; chkMask.checked = false;
      } else if (toggleId === "chkMask" && chkMask.checked) {
        chkInf.checked = false; chkLan.checked = false;
      }
      updateResearchList();
      renderResearchCards();
      scheduleCalc();
    }
    function handleVPCheck(toggleId) {
      const chkVP10 = document.getElementById("chkVP10");
      const chkVP15 = document.getElementById("chkVP15");
      if (toggleId === "chkVP10" && chkVP10.checked) chkVP15.checked = false;
      else if (toggleId === "chkVP15" && chkVP15.checked) chkVP10.checked = false;
      scheduleCalc();
    }
    // ‚úÖ SVS Ï†êÏàò Ï†ÑÏö© Ìè¨Îß∑ (M/B, ÏÜåÏàò 2ÏûêÎ¶¨)
    function formatSVS(value){
      const num = Number(value);
      if (!Number.isFinite(num)) return "0";
      if (num >= 1000000000) return (num / 1000000000).toFixed(2).replace(/\.00$/, '') + "B";
      if (num >= 1000000) return (num / 1000000).toFixed(2).replace(/\.00$/, '') + "M";
      return num.toLocaleString();
    }
    // Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
    document.addEventListener("change", (e) => {
      if (e.target.id === "chkVP10" || e.target.id === "chkVP15" || e.target.id === "chkServerBuff") scheduleCalc();
      if (e.target.id === "speedPercent" || e.target.id === "owned-Í∞ÄÎ£®" || e.target.id === "owned-Ï≤†Í∞ïÏû¨") scheduleCalc();
      if (e.target.id === "chkInf") handleCheck("chkInf");
      if (e.target.id === "chkLan") handleCheck("chkLan");
      if (e.target.id === "chkMask") handleCheck("chkMask");
      if (e.target.id === "chkVP10") handleVPCheck("chkVP10");
      if (e.target.id === "chkVP15") handleVPCheck("chkVP15");
    });

    /* ========== Í≥ÑÏÇ∞ Î°úÏßÅ (Î∂ÑÎ¶¨) ========== */
    function calculateTotals(){
      let total = { Í∞ÄÎ£®: 0, Ï≤†Í∞ïÏû¨: 0, ÏãúÍ∞Ñ: 0 };

      // Ïó∞Íµ¨ÏÜçÎèÑ/Î≤ÑÌîÑ Í≥ÑÏàò (ÏãúÍ∞ÑÏóêÎßå Ï†ÅÏö©)
      let factor = (parseFloat(document.getElementById("speedPercent").value) || 0) * 0.01 + 1;
      if (document.getElementById("chkVP10").checked) factor += 0.10;
      if (document.getElementById("chkVP15").checked) factor += 0.15;
      if (document.getElementById("chkServerBuff").checked) factor += 0.10;

      researchList.forEach(item => {
        const curEl = document.getElementById(`current-${item.key}`);
        const tgtEl = document.getElementById(`target-${item.key}`);
        if (!curEl || !tgtEl) return;

        const cur = parseInt(curEl.value, 10);
        const tgt = parseInt(tgtEl.value, 10);
        if (!Number.isFinite(cur) || !Number.isFinite(tgt) || cur >= tgt) return;

        const data = researchData[item.key] || [];
        for (let lv = cur + 1; lv <= tgt; lv++) {
          const row = data.find(r => r.level === lv);
          if (!row) continue;

          total.Í∞ÄÎ£® += row.Í∞ÄÎ£® || 0;
          total.Ï≤†Í∞ïÏû¨ += row.Ï≤†Í∞ïÏû¨ || 0;
          total.ÏãúÍ∞Ñ += parseTimeToSeconds(row.ÏãúÍ∞Ñ) || 0;
        }
      });

      return { total, factor };
    }
    
    function renderSummary(){
      const { total, factor } = calculateTotals();

      // Î≥¥Ïú†Îüâ
      const ownedDust  = parseFloat(document.getElementById("owned-Í∞ÄÎ£®").value) || 0;
      const ownedSteel = parseFloat(document.getElementById("owned-Ï≤†Í∞ïÏû¨").value) || 0;

      const totalTime = Math.round(total.ÏãúÍ∞Ñ / factor);

      // Ï¥ùÌï©
      document.getElementById("sum-Í∞ÄÎ£®").textContent   = total.Í∞ÄÎ£®.toLocaleString();
      document.getElementById("sum-Ï≤†Í∞ïÏû¨").textContent = total.Ï≤†Í∞ïÏû¨.toLocaleString();
      document.getElementById("sum-ÏãúÍ∞Ñ").textContent   = formatTime(totalTime);

      // Í≥ºÎ∂ÄÏ°±(Î≥¥Ïú† - ÌïÑÏöî)  ‚Üê ÎÑà ÏõêÎûò Î∞©Ïãù Í∑∏ÎåÄÎ°ú
      const defA = document.getElementById("def-Í∞ÄÎ£®");
      const defB = document.getElementById("def-Ï≤†Í∞ïÏû¨");

      const vA = ownedDust - total.Í∞ÄÎ£®;
      const vB = ownedSteel - total.Ï≤†Í∞ïÏû¨;

      defA.textContent = vA.toLocaleString();
      defB.textContent = vB.toLocaleString();

      defA.classList.toggle("text-red-600", vA < 0);
      defB.classList.toggle("text-red-600", vB < 0);
    }

    document.getElementById("btn-calc-total")?.addEventListener("click", () => { renderSummary();});

    /* ========== Í≥ÑÏÇ∞ Î°úÏßÅ (ÏûêÎèô) ========== */
    function calculateResearch() {
      let total = { Í∞ÄÎ£®: 0, Ï≤†Í∞ïÏû¨: 0, ÏãúÍ∞Ñ: 0 };
      let rows = "";

      // Ïó∞Íµ¨ÏÜçÎèÑ/Î≤ÑÌîÑ Í≥ÑÏàò (ÏãúÍ∞ÑÏóêÎßå Ï†ÅÏö©)
      let factor = (parseFloat(document.getElementById("speedPercent").value) || 0) * 0.01 + 1;
      if (document.getElementById("chkVP10").checked) factor += 0.10;
      if (document.getElementById("chkVP15").checked) factor += 0.15;
      if (document.getElementById("chkServerBuff").checked) factor += 0.10;

      // Ïπ¥Îìú Ïö∞Ï∏° Ìï©Í≥Ñ Ï¥àÍ∏∞Ìôî
      researchList.forEach(item => {
        const dEl = document.getElementById(`subtotal-dust-${item.key}`);
        const sEl = document.getElementById(`subtotal-steel-${item.key}`);
        const tEl = document.getElementById(`subtotal-time-${item.key}`);
        if (dEl) dEl.textContent = "0";
        if (sEl) sEl.textContent = "0";
        if (tEl) tEl.textContent = "0";
      });

      // Í∞Å Ïπ¥ÎìúÎ≥Ñ Í≥ÑÏÇ∞
      researchList.forEach(item => {
        const cur = parseInt(document.getElementById(`current-${item.key}`).value);
        const tgt = parseInt(document.getElementById(`target-${item.key}`).value);

        const data = researchData[item.key];
        const subtotal = { Í∞ÄÎ£®: 0, Ï≤†Í∞ïÏû¨: 0, ÏãúÍ∞Ñ: 0 };

        if (cur < tgt) {
          for (let lv = cur + 1; lv <= tgt; lv++) {
            const row = data.find(r => r.level === lv);
            if (!row) continue;
            subtotal.Í∞ÄÎ£® += row.Í∞ÄÎ£® || 0;
            subtotal.Ï≤†Í∞ïÏû¨ += row.Ï≤†Í∞ïÏû¨ || 0;
            subtotal.ÏãúÍ∞Ñ += parseTimeToSeconds(row.ÏãúÍ∞Ñ) || 0;
          }
        }

        // ‚úÖ Ïπ¥Îìú Ïö∞Ï∏° "ÌïÑÏöî Ìï©Í≥Ñ" Í∞±Ïã†(Ï≤¥ÌÅ¨ÏôÄ Î¨¥Í¥Ä)
        const dEl = document.getElementById(`subtotal-dust-${item.key}`);
        const sEl = document.getElementById(`subtotal-steel-${item.key}`);
        const tEl = document.getElementById(`subtotal-time-${item.key}`);
        if (dEl) dEl.textContent = subtotal.Í∞ÄÎ£®.toLocaleString();
        if (sEl) sEl.textContent = subtotal.Ï≤†Í∞ïÏû¨.toLocaleString();
        if (tEl) tEl.textContent = formatTime(Math.round(subtotal.ÏãúÍ∞Ñ / factor));
        
        // ‚úÖ SVS Ï†êÏàò = (Í∞ÄÎ£®*1000) √ó (1 + Î∞úÎ†àÎ¶¨ÏïÑ Î≥¥ÎÑàÏä§)
        const shard = (subtotal.Í∞ÄÎ£® * 1000);
        const vBonus = getValeriaBonus(); // 0 ~ 0.20      
        const sScore = Math.floor(shard * (1 + vBonus));        
        const tScore = Math.floor((subtotal.ÏãúÍ∞Ñ/60) * (1 + vBonus));        
        let finalScore = sScore+tScore;

        const scoreEl = document.getElementById(`sub-Ï†êÏàò-${item.label}`);
        if (scoreEl) scoreEl.textContent = finalScore.toLocaleString();
        
        if (cur < tgt) {
          total.Í∞ÄÎ£® += subtotal.Í∞ÄÎ£®;
          total.Ï≤†Í∞ïÏû¨ += subtotal.Ï≤†Í∞ïÏû¨;
          total.ÏãúÍ∞Ñ += subtotal.ÏãúÍ∞Ñ;

          rows += `
            <tr class="text-center">
              <td class="border p-1">${item.label}</td>
              <td class="border p-1">${cur} ‚Üí ${tgt}</td>
              <td class="border p-1">${subtotal.Í∞ÄÎ£®.toLocaleString()}</td>
              <td class="border p-1">${subtotal.Ï≤†Í∞ïÏû¨.toLocaleString()}</td>
              <td class="border p-1">${formatTime(Math.round(subtotal.ÏãúÍ∞Ñ / factor))}</td>
            </tr>`;
        }
      });
    
      sendHeightToParent();
    }

    // Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏ ÎîîÎ∞îÏö¥Ïä§
    let calcTimer = null;
    function scheduleCalc() {
      if (calcTimer) clearTimeout(calcTimer);
      calcTimer = setTimeout(calculateResearch, 120);
    }

    // Ï¥àÍ∏∞ ÏÑ∏ÌåÖ
    updateResearchList();
    renderResearchCards();
    scheduleCalc();

    // Ïà´Ïûê ÏûÖÎ†• Ï¶âÏãú Í≥ÑÏÇ∞
    ["owned-Í∞ÄÎ£®","owned-Ï≤†Í∞ïÏû¨","speedPercent"].forEach(id=>{
      const el = document.getElementById(id);
      if (el) el.addEventListener("input", scheduleCalc);
    });

    /* Ïú†Ìã∏ */
    function sendHeightToParent(){ 
      const height = document.body.scrollHeight + 10;
      window.parent?.postMessage?.({ type: "FRAME_CHANGE", height }, "*");
    }
    window.addEventListener("load", ()=> setTimeout(sendHeightToParent,100));
  </script>
  <script>
    // F12, Ctrl+Shift+I, Ctrl+U Îì± Î∞©ÏßÄ
    document.onkeydown = function (e) {
      if (
        e.keyCode === 123 || // F12
        (e.ctrlKey && e.shiftKey && e.keyCode === 73) || // Ctrl+Shift+I
        (e.ctrlKey && e.shiftKey && e.keyCode === 74) || // Ctrl+Shift+J
        (e.ctrlKey && e.keyCode === 85) // Ctrl+U
      ) {
        e.preventDefault();
        return false;
      }
    };
  
    // Ïö∞ÌÅ¥Î¶≠ Î∞©ÏßÄ
    document.addEventListener("contextmenu", (e) => e.preventDefault());
  </script>
  <script>
    window.addEventListener('message', (e) => {
      if (e.data?.type === 'DARK_MODE') {
        document.body.classList.toggle('dark-mode', e.data.value);
      }
    });
  </script>  
  <style>
    .toggle-btn{ transition:.12s ease; user-select:none; }
    .toggle-btn:active{ transform:scale(.98); }

    /* OFF */
    .toggle-btn{
      background: transparent;
      border-color: rgba(148,163,184,.65);
      color: inherit;
    }

    /* ON (Í±¥Î¨ºÍ≥ÑÏÇ∞Í∏∞ Ïä§ÌÉÄÏùº: ÌååÎûÄ Î∞∞Í≤Ω + Ìù∞ Í∏ÄÏûê) */
    .toggle-btn.is-on{
      background: #2563eb;   /* blue-600 */
      border-color: #1d4ed8; /* blue-700 */
      color: #fff;
    }

    /* Îã§ÌÅ¨Î™®Îìú OFF Î≤ÑÌäº ÌÖåÎëêÎ¶¨ */
    body.dark-mode .toggle-btn{ border-color:#444; }
  </style>
  <script>
    /* ===== ÌïµÏã¨: Î≤ÑÌäº ‚Üí Ï≤¥ÌÅ¨Î∞ïÏä§ ‚Üí Í∏∞Ï°¥ Î°úÏßÅ ===== */
    function setBtn(btn,on){
      btn.classList.toggle('is-on',on);
    }
    document.querySelectorAll('.toggle-btn').forEach(btn=>{
      const chk = document.getElementById(btn.dataset.toggle);
      if (chk) btn.classList.toggle('is-on', chk.checked);

      btn.addEventListener('click', () => {
        const group=btn.dataset.group;
        
        if (group === 'troop') {
          document.querySelectorAll('.toggle-btn[data-group="troop"]').forEach(b=>{
            const c = document.getElementById(b.dataset.toggle);
            c.checked = false;
            b.classList.remove('is-on');
          });
          chk.checked = true;
          btn.classList.add('is-on');
        }
        else {
          chk.checked = !chk.checked;
          btn.classList.toggle('is-on', chk.checked);
        }
        chk.dispatchEvent(new Event('change', { bubbles:true }));
      });
    });

    /* ===== Í∏∞Ï°¥ Í≥ÑÏÇ∞ Î°úÏßÅÏùÄ Í∑∏ÎåÄÎ°ú ===== */
    document.addEventListener('change',(e)=>{
      const id = e.target.id;
      if(id === "chkExpertV")  getValeriaDesc();
      scheduleCalc();
    });
    
    ['owned-Í∞ÄÎ£®','owned-Ï≤†Í∞ïÏû¨','speedPercent'].forEach(id=>{
      document.getElementById(id)?.addEventListener('input',scheduleCalc);
    });
  </script>
</body>
</html>
