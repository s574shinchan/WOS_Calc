<!DOCTYPE html>
<html lang="ko">
<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>SVS 점수계산</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* 1) 라이트 기본 팔레트 */
      :root{
        --bg:#ffffff;         /* 페이지 배경 */
        --text:#111827;       /* 텍스트 색 */ 
        --card:#ffffff;       /* 카드/표 배경 */
        --head:#f3f4f6;       /* thead 배경 */
        --border:#e5e7eb;     /* 테두리 */
        --in:#d1fae5;         /* 입력칸(초록) */
        --sum:#fef08a;        /* 합계(노랑) */
        --tab-bg:#f9fafb;     /* 비선택 탭 배경 */
      }

      /* 2) 다크모드 팔레트 (body.dark-mode 클래스 사용 시) */
      body.dark-mode{
        --bg:#0b1220;
        --text:#e5e7eb;
        --card:#0f172a;
        --head:#111827;
        --border:#374151;
        --in:#134e4a;
        --sum:#a57c00;
        --tab-bg:#1f2937;
      }

      /* 3) 공통 스타일 */
      body{ background:var(--bg); color:var(--text); }
      .card{ background:var(--card); box-shadow:0 8px 24px rgba(0,0,0,.06) }
      .t{ border-collapse:collapse; width:100%; color:var(--text) }
      .t th,.t td{ border:1px solid var(--border); padding:.5rem; font-size:13px; vertical-align:top }
      .head{ background:var(--head); font-weight:600 }
      .in{ background:var(--in) }      /* 입력 영역(초록) */
      .sum{ background:var(--sum) }    /* 합계(노랑) */
      .r{text-align:right}
      .c{ text-align:center !important; }
      .c input[type="checkbox"]{ display:block; margin:0 auto; }
    	.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; text-align: right}
			.tin{ background:var(--in); border:1px solid var(--border); border-radius:9999px; padding:.45rem .95rem; text-align:right; font-size:1rem }
			.tintb { background:var(--in); padding:.45rem .95rem; text-align:right; font-size:1rem }
			.tcap{ font-size:.83rem; color:var(--muted) }
			.tlabel{ font-size:1.05rem; font-weight:800 }
			.tile{
				background:var(--card); border:1px solid var(--border); border-radius:16px;
				box-shadow:var(--shadow); padding:1.05rem 1.1rem;
			}
      input[type="number"]{
        appearance:textfield; background:transparent; color:var(--text);
      }
      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button{ appearance:none; margin:0 }

      .maxw{max-width:1100px}

      /* 4) 탭 */
      .tabs{
        display:flex; gap:.25rem;
        border-bottom:1px solid var(--border);
        margin-bottom:.75rem
      }
      .tab-btn{
        padding:.6rem 1rem; font-weight:600;
        border:1px solid var(--border); border-bottom:0;
        border-top-left-radius:.6rem; border-top-right-radius:.6rem;
        background:var(--tab-bg); color:var(--text)
      }
      .tab-btn[aria-selected="true"]{ background:var(--card) }
      .tab-panel{ display:none }
      .tab-panel.active{ display:block }

      /* 좌우 2열 그리드 (모바일 1열) */
      .cols{ display:grid; grid-template-columns:1fr; gap:.75rem; align-items:start; }
      .col-qty{ background:var(--in) }
			.row-sub td{ background:var(--sum); font-weight:700 }
			.grid-wrap{ display:grid; grid-template-columns:1fr; gap:1rem }
			@media (min-width:1100px){ .grid-wrap{ grid-template-columns: 1fr 1.2fr; } }

			.dense th, .dense td{ padding:.36rem .42rem; font-size:.92rem; line-height:1.25 }
			.dense .col-qty input{ height:38px; padding:.2rem .6rem; font-size:.9rem }

			/* ▼ 병사 테이블 밀집 모드 */
			.table-dense th, .table-dense td{
				padding:.32rem .42rem;
				line-height:1.15;
				font-size:.92rem;
			}
			.table-dense thead th{ padding:.36rem .42rem }
			.table-dense .col-qty input.tin.qty{
				height:40px; padding:.22rem .6rem; font-size:.9rem;
			}
			.table-dense .pts{ white-space:nowrap; }
		</style>
	</head>
	<body class="p-3 md:p-6">
		<div class="max-w-[1500px]">
			<!-- 탭 버튼 -->
			<div class="tabs">
				<button class="tab-btn" data-tab="day1" aria-selected="true">1일차</button>
				<button class="tab-btn" data-tab="day2" aria-selected="false">2일차</button>
        <button class="tab-btn" data-tab="day3" aria-selected="false">3일차</button>
        <button class="tab-btn" data-tab="day4" aria-selected="false">4일차</button>
        <button class="tab-btn" data-tab="day5" aria-selected="false">5일차</button>
      </div>

			<!-- 탭 컨텐츠(iframe 하나만 사용) -->
			<iframe class="w-full" id="tab-frame" title="SVS 탭 컨텐츠" referrerpolicy="no-referrer" style="height: 1420px;"></iframe>
    </div>
		
    <script>
			// 탭별 파일 매핑
			const FILES = {
				day1: 'SVSPre1.html',
				day2: 'SVSPre2.html',
				day3: 'SVSPre3.html',
				day4: 'SVSPre4.html',
				day5: 'SVSPre5.html',
			};

			const frame = document.getElementById('tab-frame');

			function setTab(tab){
				// 탭 버튼 상태
				document.querySelectorAll('.tab-btn').forEach(b=>{
					b.setAttribute('aria-selected', String(b.dataset.tab === tab));
				});

				// 캐시 회피 쿼리 추가(배포 후 최신 반영 보장)
				const url = FILES[tab] + '?v=' + Date.now();
				frame.src = url;
			}

			// 부모 ← 자식(iframe) 높이 동기화: 서브 HTML에서 postMessage({type:'FRAME_CHANGE', height}) 호출 시 반영
			window.addEventListener('message', (e)=>{
				if(!e.data || typeof e.data !== 'object') return;
				if(e.data.type === 'FRAME_CHANGE' && Number.isFinite(e.data.height)){
					frame.style.height = e.data.height + 'px';
				} else if(e.data.type === 'SET_FRAME_SIZE' && e.data.height){
					frame.style.height = e.data.height;
					if(e.data.width) frame.style.width = e.data.width;
				}
			});

			// 탭 클릭
			document.querySelectorAll('.tab-btn').forEach(btn=>{
				btn.addEventListener('click', ()=> setTab(btn.dataset.tab));
			});

			// 첫 진입: 1일차
			document.addEventListener('DOMContentLoaded', ()=> setTab('day1'));

<<<<<<< HEAD
			// 임베드 페이지 사이즈 변화 대비(모바일 회전 등)
			//window.addEventListener('resize', ()=>{
				// 서브가 다시 높이 보내도록 유도(선택사항)
				//frame.contentWindow?.postMessage({type:'REQ_FRAME_SIZE'}, '*');
			//});
=======
      /* --- Pet Refine --- */
      function d3_buildPetRef(){
        const tb = document.getElementById("d3_petRefBody"); 
        tb.innerHTML = "";
        Object.entries(D3_PET_REF_BASE).forEach(([name, base], i)=>{
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${name}</td>
            <td class="r mono">${fmt(base)}</td>
            <td class="in">
              <input class="w-full r mono d3_petRefQty" type="number" min="0" step="1" value="0"
                     data-name="${name}" data-idx="${i}">
            </td>
            <td class="r mono" id="d3_petRefPts-${i}">-</td>`;
          tb.appendChild(tr);
        });
        tb.addEventListener("input", e=>{
          if(!e.target.classList.contains("d3_petRefQty")) return;
          d3_calcPetRef();
        });
      }

      // 2) 계산: 인덱스로 대응되는 셀을 찾아서 채웁니다.
      function d3_calcPetRef(){
        let sub = 0;
        document.querySelectorAll(".d3_petRefQty").forEach(inp=>{
          const name = inp.dataset.name;
          const idx  = +inp.dataset.idx;
          const base = D3_PET_REF_BASE[name];
          const qty  = +(inp.value || 0);
          const pts  = qty * base;
          document.getElementById("d3_petRefPts-"+idx).textContent = d3_show(pts);
          sub += pts;
        });
        document.getElementById("d3_petRefTotal").textContent = d3_show(sub);
        document.getElementById("d3_petRefPtsTop").textContent = d3_show(sub);
        d3_calcTotal();
      }

      function d3_buildPolar(){
        document.getElementById("d3_polarEA").textContent = fmt(D3_POLAR_EA);
        const tb=document.getElementById("d3_polarBody"); tb.innerHTML="";
        D3_POLAR_STRATS.forEach(({key})=>{
          const id = d3_safe(key);
          const tr=document.createElement("tr");
          tr.innerHTML=`
            <td>${key}</td>
            <td class="r mono" id="d3_polRallies-${id}">-</td>
            <td class="r mono" id="d3_polPts-${id}">-</td>
            <td class="c"><input type="checkbox" class="d3_polPick" data-key="${key}" id="d3_pick-${id}"></td>`;
          tb.appendChild(tr);
        });

        tb.addEventListener("change", e=>{
          if(!e.target.classList.contains("d3_polPick")) return;
          document.querySelectorAll(".d3_polPick").forEach(chk=>{
            if(chk!==e.target) chk.checked=false; // 단일 선택
          });
          d3_updatePolarPick();
        });

        document.getElementById("d3_stStart").addEventListener("input", d3_calcPolar);
        document.getElementById("d3_stChief").addEventListener("input", d3_calcPolar);

        d3_calcPolar();
      }
      
      function d3_calcPolar(){
        const start = +( (document.getElementById("d3_stStart").value) || 0 );
        const chief = +( (document.getElementById("d3_stChief").value) || 0 );
        const totalSt = start + (chief * 10);
        document.getElementById("d3_stTotal").textContent = totalSt>0 ? fmt(totalSt) : "-";

        D3_POLAR_STRATS.forEach(({key,a,b})=>{
          const id = d3_safe(key);
          if(totalSt>0){
            const avgCost = (a===0) ? 25 : ((20 + 25*b)/(a+b));
            const ralliesRaw = totalSt/avgCost;
            const rallies = Math.round(ralliesRaw);
            const points  = Math.round(ralliesRaw * D3_POLAR_EA);
            document.getElementById("d3_polRallies-"+id).textContent = d3_show(rallies);
            document.getElementById("d3_polPts-"+id).textContent     = d3_show(points);
          }else{
            document.getElementById("d3_polRallies-"+id).textContent = "-";
            document.getElementById("d3_polPts-"+id).textContent     = "-";
          }
        });

        d3_updatePolarPick();
      }
      
      function d3_updatePolarPick(){
        let selected=0;
        D3_POLAR_STRATS.forEach(({key})=>{
          const id=d3_safe(key);
          const picked = document.getElementById("d3_pick-"+id).checked;
          if(picked){
            const pts = +document.getElementById("d3_polPts-"+id).textContent.replace(/,/g,'') || 0;
            selected = pts;
          }
        });
        document.getElementById("d3_polarSelected").textContent = d3_show(selected);
        document.getElementById("d3_polarPtsTop").textContent   = d3_show(selected);
        d3_calcTotal();
      }

      function d3_parseNum(s){
        return (!s || s==='-') ? 0 : +s.replace(/,/g,'');
      }
      
      function d3_calcTotal(){
        const total =
          d3_parseNum(document.getElementById("d3_wPts").textContent) +
          d3_parseNum(document.getElementById("d3_heroPts").textContent) +
          d3_parseNum(document.getElementById("d3_charmsPts").textContent) +
          d3_parseNum(document.getElementById("d3_beastPtsTop").textContent) +
          d3_parseNum(document.getElementById("d3_petAdvPtsTop").textContent) +
          d3_parseNum(document.getElementById("d3_petRefPtsTop").textContent) +
          d3_parseNum(document.getElementById("d3_polarPtsTop").textContent) +
					d3_parseNum(document.getElementById("d3_pExp1").textContent) +
					d3_parseNum(document.getElementById("d3_pExp2").textContent);
        document.getElementById("d3_total").textContent = d3_show(total)||0;
      }

      function d3_init(){
        d3_buildCharms(); 
        d3_buildBeasts(); 
        d3_buildPetAdv(); 
        d3_buildPetRef(); 
        d3_buildPolar();
        d3_calcWheel();
        d3_calcHero();
        d3_calcCharms();
        d3_calcBeasts();
        d3_calcPetAdv(); 
        d3_calcPetRef();
				d3_calcExps();
        d3_calcTotal();
      }
      d3_init();

      /* ===================== Day 4 ===================== */
      const D4_UNIT = { widgets:8000, essence:4000, mithril:144000 };
      const D4_TROOP_PTS = { T1:3,T2:4,T3:5,T4:8,T5:12,T6:18,T7:25,T8:35,T9:45,T10:60,T11:75 };
      const D4_CHAR_BASE = {1:625,2:1250,3:3125,4:8750,5:11250,6:12500,7:12500,8:13000,9:14000,10:15000,11:16000,12:17000,13:18000,14:19000,15:20000,16:21000};

      function d4_buildTroops(){
        const tb = document.getElementById("d4_tBody");
        tb.innerHTML = "";
        Object.keys(D4_TROOP_PTS).forEach((tier) => {
          const per = D4_TROOP_PTS[tier];
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${tier}</td>
            <td class="r font-mono">${fmt(per)}</td>
            <td class="in">
              <input class="w-full r font-mono d4_tQty" type="number" min="0" step="1" value="0" data-tier="${tier}" />
            </td>
            <td class="r font-mono" id="d4_tCalc-${tier}">-</td>
          `;
          tb.appendChild(tr);
        });

        tb.addEventListener("input", (e) => {
          if (!e.target.classList.contains("d4_tQty")) return;
          d4_calcTroops();
        });
      }

      function d4_calcTroops(){
        let sub = 0;
        document.querySelectorAll(".d4_tQty").forEach((inp) => {
          const tier = inp.dataset.tier;
          const per  = D4_TROOP_PTS[tier];
          const qty  = +(inp.value || 0);
          const pts  = qty * per;
          document.getElementById("d4_tCalc-" + tier).textContent = fmt(pts);
          sub += pts;
        });
        document.getElementById("d4_tTot").textContent = fmt(sub);
        document.getElementById("d4_tTot").dataset.val = sub;
        d4_calcMain();
      }

      function d4_buildCharms(){
        const tb=document.getElementById("d4_charBody"); tb.innerHTML="";
        for(let lv=1; lv<=16; lv++){
          const tr=document.createElement("tr");
          tr.innerHTML=`
            <td>${lv}</td>
            <td class="r font-mono">${fmt(D4_CHAR_BASE[lv])}</td>
            <td class="in"><input class="w-full r font-mono d4_cQty" type="number" min="0" max="18" step="1" value="0" data-lv="${lv}" /></td>
            <td class="r font-mono" id="d4_cP-${lv}">-</td>`;
          tb.appendChild(tr);
        }
        tb.addEventListener("input",e=>{ if(!e.target.classList.contains("d4_cQty")) return; d4_calcCharms(); });
      }

      function d4_calcCharms(){
        let sub=0;
        document.querySelectorAll(".d4_cQty").forEach(inp=>{
          const lv=+inp.dataset.lv; let qty=+(inp.value||0);
          if(qty>18){ qty=18; inp.value=18; }
          const pts=qty*70*D4_CHAR_BASE[lv];
          document.getElementById("d4_cP-"+lv).textContent=fmt(pts); sub+=pts;
        });
        document.getElementById("d4_charTot").textContent=fmt(sub); document.getElementById("d4_charTot").dataset.val=sub; d4_calcMain();
      }

      function d4_calcMain(){
        const pW=(+((document.getElementById("d4_qWid").value)||0))*D4_UNIT.widgets;
        const pE=(+((document.getElementById("d4_qEss").value)||0))*D4_UNIT.essence;
        const pM=(+((document.getElementById("d4_qMit").value)||0))*D4_UNIT.mithril;
        document.getElementById("d4_pWid").textContent=fmt(pW); document.getElementById("d4_pEss").textContent=fmt(pE); document.getElementById("d4_pMit").textContent=fmt(pM);
        const ch=+((document.getElementById("d4_charTot").dataset.val)||0), tp=+((document.getElementById("d4_tTot").dataset.val)||0);
        document.getElementById("d4_pCharms").textContent=fmt(ch); document.getElementById("d4_pTroop").textContent=fmt(tp);
        document.getElementById("d4_total").textContent=fmt(pW+pE+pM+ch+tp);
      }

      ["#d4_qWid","#d4_qEss","#d4_qMit"].forEach(s=>document.querySelector(s).addEventListener("input", d4_calcMain));
      d4_buildTroops(); 
      d4_buildCharms(); 
      d4_calcTroops();
      d4_calcCharms();
      d4_calcMain();

      /* ===================== Day5 ===================== */
      const D5_UNIT = {
        fire:2000, shard:1000, refined:30000, widgets:8000, essence:4000, mithril:144000,
        spdPerMin:30, chiefMul:36, petAdvMul:50
      };
      
      // Pet advancement (BasePoint)
      const D5_PET_ADV_BASE = {
        "Level 10":500,"Level 20":1000,"Level 30":2000,"Level 40":3000,
        "Level 50":4500,"Level 60":6750,"Level 70":10000,"Level 80":12000,
        "Level 90":14500,"Level 100":17500
      };
      
      // Pet Refine unit points
      const D5_REF = { common:1150, advanced:15000 };
      
      /* Chief Gear: 행별 기본점수(스샷 기준값; 필요시 여기서 수정) */
      const D5_CHIEF_BASE = {
        "고급":1125,
        "고급 1성":1875,
        "레어":3000,
        "레어 1성":4500,
        "레어 2성":5100,
        "레어 3성":5440,
        "에픽":3230,
        "에픽 1성":3230,
        "에픽 2성":3225,
        "에픽 3성":3225,
        "에픽 T1":3230,
        "에픽 T1 1성":3440,
        "에픽 T1 2성":4085,
        "에픽 T1 3성":4085,
        "레전드 (전체)":6250,
        "신화 (전체)":9560
      };
      
      const d5show = n => (isFinite(n) && n>0 ? n.toLocaleString() : "-");
      
      /* --- Speedups --- */
      function d5_calcSpeed(){
        const d=+(document.getElementById("d5_spdD").value||0),
              h=+(document.getElementById("d5_spdH").value||0),
              m=+(document.getElementById("d5_spdM").value||0);
        const mins=d*1440+h*60+m, pts=mins*D5_UNIT.spdPerMin;
        document.getElementById("d5_spdDP").textContent=d5show(d*1440*D5_UNIT.spdPerMin);
        document.getElementById("d5_spdHP").textContent=d5show(h*60*D5_UNIT.spdPerMin);
        document.getElementById("d5_spdMP").textContent=d5show(m*D5_UNIT.spdPerMin);
        document.getElementById("d5_spdMin").textContent=d5show(mins);
        document.getElementById("d5_spdTot").textContent=d5show(pts);
        document.getElementById("d5_pSpd").textContent = d5show(pts);
        d5_calcMain();
      }
      ["#d5_spdD","#d5_spdH","#d5_spdM"].forEach(s=>document.querySelector(s).addEventListener("input", d5_calcSpeed));
      
      /* --- Pet advancement --- */
      function d5_buildPetAdv(){
        const tb=document.getElementById("d5_petAdvBody"); tb.innerHTML="";
        Object.entries(D5_PET_ADV_BASE).forEach(([name,base])=>{
          const id = name.replace(/\s|\W/g,'');
          const tr=document.createElement("tr");
          tr.innerHTML = `
            <td>${name}</td>
            <td class="r mono">${base.toLocaleString()}</td>
            <td class="in"><input class="w-full r mono d5_petAdvQty" data-name="${name}" type="number" min="0" step="1" value="0"></td>
            <td class="r mono" id="d5_petAdvPts-${id}">-</td>`;
          tb.appendChild(tr);
        });
        tb.addEventListener("input", e=>{
          if(!e.target.classList.contains("d5_petAdvQty")) return;
          d5_calcPetAdv();
        });
      }
      function d5_calcPetAdv(){
        let sub=0;
        document.querySelectorAll(".d5_petAdvQty").forEach(inp=>{
          const name=inp.dataset.name, base=D5_PET_ADV_BASE[name], qty=+(inp.value||0);
          const pts = qty * D5_UNIT.petAdvMul * base;
          document.getElementById("d5_petAdvPts-"+name.replace(/\s|\W/g,'')).textContent=d5show(pts);
          sub += pts;
        });
        document.getElementById("d5_petAdvTotal").textContent=d5show(sub);
        document.getElementById("d5_pPetAdv").textContent=d5show(sub);
        d5_calcMain();
      }
      
      /* --- Pet Refine --- */
      function d5_calcRef(){
        const c = +((document.getElementById("d5_refC").value)||0) * D5_REF.common;
        const a = +((document.getElementById("d5_refA").value)||0) * D5_REF.advanced;
        document.getElementById("d5_refCP").textContent=d5show(c);
        document.getElementById("d5_refAP").textContent=d5show(a);
        const sub=c+a;
        document.getElementById("d5_refTot").textContent=d5show(sub);
        document.getElementById("d5_pPetRef").textContent=d5show(sub);
        d5_calcMain();
      }
      ["#d5_refC","#d5_refA"].forEach(s=>document.querySelector(s).addEventListener("input", d5_calcRef));
      
      /* --- Chief Gear --- */
      function d5_buildChief(){
        const tb=document.getElementById("d5_chiefBody"); tb.innerHTML="";
        Object.entries(D5_CHIEF_BASE).forEach(([name,base])=>{
          const id = name.replace(/\s|\W/g,'');
          const tr=document.createElement("tr");
          tr.innerHTML = `
            <td>${name}</td>
            <td class="r mono">${base.toLocaleString()}</td>
            <td class="in"><input class="w-full r mono d5_chQty" data-name="${name}" type="number" min="0" step="1" value="0"></td>
            <td class="r mono" id="d5_chPts-${id}">-</td>`;
          tb.appendChild(tr);
        });
        tb.addEventListener("input", e=>{
          if(!e.target.classList.contains("d5_chQty")) return;
          d5_calcChief();
        });
      }
      function d5_calcChief(){
        let sub=0;
        document.querySelectorAll(".d5_chQty").forEach(inp=>{
          const name=inp.dataset.name, base=D5_CHIEF_BASE[name], qty=+(inp.value||0);
          const pts = qty * D5_UNIT.chiefMul * base;
          document.getElementById("d5_chPts-"+name.replace(/\s|\W/g,'')).textContent=d5show(pts);
          sub += pts;
        });
        document.getElementById("d5_chiefTot").textContent=d5show(sub);
        document.getElementById("d5_pChief").textContent=d5show(sub);
        d5_calcMain(); 
      }
      
      /* --- 메인 합계(소계 + 고정 재료) --- */
      function d5_num(text){ return (!text || text==='-') ? 0 : +text.replace(/,/g,''); }
      function d5_calcMain(){
        // 고정 재료: 수량 입력이 없으므로 '1개 사용시' 개념으로 합계? → 스샷 구조상 하위표에서만 입력받고 합계 반영
        // 이 파일에서는 하위표(스피드업/기어/펫)에서만 값이 생기므로, 상단 재료 6종은 별도 입력칸을 두지 않고 0 처리.
        const pFire=0, pShard=0, pRef=0, pWid=0, pEss=0, pMit=0;
      
        const pSpd   = d5_num(document.getElementById("d5_pSpd").textContent);
        const pChief = d5_num(document.getElementById("d5_pChief").textContent);
        const pAdv   = d5_num(document.getElementById("d5_pPetAdv").textContent);
        const pRefi  = d5_num(document.getElementById("d5_pPetRef").textContent);
      
        document.getElementById("d5_pFire").textContent  = d5show(pFire);
        document.getElementById("d5_pShard").textContent = d5show(pShard);
        document.getElementById("d5_pRef").textContent   = d5show(pRef);
        document.getElementById("d5_pWid").textContent   = d5show(pWid);
        document.getElementById("d5_pEss").textContent   = d5show(pEss);
        document.getElementById("d5_pMit").textContent   = d5show(pMit);
      
        const total = pFire+pShard+pRef+pWid+pEss+pMit + pSpd + pChief + pAdv + pRefi;
        document.getElementById("d5_total").textContent = d5show(total)||0;
      }
      
      /* init Day5 */
      d5_buildPetAdv(); d5_buildChief();
      d5_calcPetAdv(); d5_calcChief(); d5_calcRef(); d5_calcSpeed(); d5_calcMain();
    </script>
    
    <script>
      /* ===================== 탭 전환 ===================== */
      document.querySelectorAll(".tab-btn").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const tab = btn.dataset.tab;
    
          // 탭 상태 전환
          document.querySelectorAll(".tab-btn")
            .forEach(b=>b.setAttribute("aria-selected", String(b===btn)));
          document.querySelectorAll(".tab-panel")
            .forEach(p=>p.classList.remove("active"));
          document.getElementById("panel-"+tab).classList.add("active");
    
          // ✅ 탭 전환 후 프레임 높이 갱신
          // 레이아웃이 적용된 다음 프레임에 높이를 계산하도록 rAF+setTimeout 사용
          requestAnimationFrame(()=>setTimeout(sendHeightToParent, 0));
          window.addEventListener("resize", ()=>setTimeout(sendHeightToParent, 50));
        });
      });
    </script>
>>>>>>> origin/main

			// (선택) 우클릭/특정 단축키 차단이 필요하면 여기에 추가 가능
			// document.addEventListener('contextmenu', e=>e.preventDefault());
		</script>
		
    <!-- (선택) 프레임 높이 통신/보안 키 차단 스크립트 -->
    <script>
			function sendHeightToParent() {
				const height = document.body.scrollHeight + 10;
				window.parent.postMessage({ type: "FRAME_CHANGE", height }, "*");
			}

			// 페이지 최초 로드 시
			window.addEventListener("load", () => {
				setTimeout(sendHeightToParent, 100); // 약간의 렌더링 대기
			});

			function loadPage(page) {
				const isMobile = window.innerWidth <= 768;
				const height = isMobile ? "550px" : "345px"
					window.location.href = page;
				window.parent.postMessage({ type: "SET_FRAME_SIZE", height: height, width: "100%"}, "*");
			}
      document.addEventListener("contextmenu", event => event.preventDefault());
      document.addEventListener("keydown", function (e) {
        if (e.key === "F12" ||
            (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
            (e.ctrlKey && (e.key === "U" || e.key === "S"))) {
          e.preventDefault();
        }
      });
    </script>
  </body>
</html>
