  <meta charset="UTF-8">
  <div class="max-w-[1500px] mx-auto bg-white rounded shadow p-2 gap-2">
    <div class="flex-1 bg-white rounded p-2 space-y-4 shadow">
      <div class="bg-gray-100 p-2 font-sans text-sm">
        <div class="bg-white p-4 rounded-xl shadow-md space-y-4">
          <h1 class="text-xl md:text-2xl font-bold text-gray-700">ğŸ“Š ì´ë¯¼ì˜ˆìƒë²”ìœ„</h1>
          <div class="text-gray-700 text-sm mb-4">
            <p>ë³€ìˆ˜ë¥¼ ì œì™¸í•œ 3ì›” ì´ë¯¼ ì˜ˆìƒí‘œ ì…ë‹ˆë‹¤.</p>
            <p>ì •í™•í•˜ì§€ ì•Šì„ìˆ˜ ìˆê³ , ì–´ë””ê¹Œì§€ë‚˜ "ì˜ˆìƒí‘œ" ì…ë‹ˆë‹¤. ì˜¤í”¼ì…œì¸ ê²ƒì²˜ëŸ¼ ì–˜ê¸°í•˜ì§€ ë§ì•„ì£¼ì‹œê¸¸ ë°”ëë‹ˆë‹¤.</p>
            <p>ã€€</p>
            <p>ê¸°ì¤€ì¼ì : ì´ë¯¼ ì±„íŒ…ì´ ì—´ë¦¬ëŠ” ì¼ìš”ì¼</p>
            <p>ë‹¤ìŒ ì„¸ëŒ€ ì˜ì›…ì´ ì í˜€ìˆëŠ” ê²½ìš° : ê¸°ì¤€ì¼ ë‹¤ìŒë‚ ì¸ ì›”ìš”ì¼ì— í•´ë‹¹ ì„¸ëŒ€ ì‹œì‘</p>
            <p>â”” ì›”ìš”ì¼ì— ì¼ì¼í˜œíƒ ë³´ìƒ ì˜ì›…ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸ê°€ëŠ¥</p>
            <p>ì´ì „ê¹Œì§€ì˜ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì˜ˆì¸¡í•œ ì •ë³´ì´ë¯€ë¡œ 100% ì •í™•í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            <p>ì´ì›ƒì™•êµ­ ë²”ìœ„ê°€ ì˜ëª»ëœ ë¶€ë¶„ì´ë‚˜ ëˆ„ë½ëœ ë¶€ë¶„ì´ ìˆë‹¤ë©´, ìš°ì¸¡ìƒë‹¨ ì˜¤í”ˆì¹´í†¡ìœ¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ë°˜ì˜í•˜ê² ìŠµë‹ˆë‹¤.</p>
          </div>
          <div id="sheet-table">â³ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        </div>
      </div>
    </div>
  </div>

<script>
  (function(){
    // âœ… SPA ì¬ì§„ì…/ì¬ë¡œë“œ ì‹œ ì´ë²¤íŠ¸ ì¤‘ë³µ ë°”ì¸ë”© ë°©ì§€
    if (window.__TRASFER_INIT_BOUND__) {
      // ì´ë¯¸ ì´ˆê¸°í™”ëœ ìƒíƒœë©´ ê·¸ëƒ¥ ì‹¤í–‰ë§Œ(í•„ìš” ì‹œ)
      window.TransferInit?.();
      return;
    }
    window.__TRASFER_INIT_BOUND__ = true;       
    
    window.TransferInit = function TransferInit(){  
      function toRGB(color, fallback = "#ffffff") {
        if (!color) return fallback;
        var r = Math.round((color.red ?? 0) * 255);
        var g = Math.round((color.green ?? 0) * 255);
        var b = Math.round((color.blue ?? 0) * 255);
        return `rgb(${r},${g},${b})`;
      }

      function toBorderColor(border) {
        if (!border?.color) return null;
        var { red = 0, green = 0, blue = 0 } = border.color;
        return `rgb(${Math.round(red * 255)},${Math.round(green * 255)},${Math.round(blue * 255)})`;
      }

      async function loadData() {
        try {
          var response = await fetch("https://wos-proxy.mko75620.workers.dev/get-sheet");
          if (!response.ok) throw new Error("í”„ë¡ì‹œ í˜¸ì¶œ ì‹¤íŒ¨");
          var data = await response.json();

          var sheet = data.sheets[0];
          var merges = sheet.merges || [];
          var rows = sheet.data[0].rowData || [];

          var mergeMap = {};
          var skip = new Set();
          for (var m of merges) {
            var key = `${m.startRowIndex},${m.startColumnIndex}`;
            mergeMap[key] = {
              rowspan: m.endRowIndex - m.startRowIndex,
              colspan: m.endColumnIndex - m.startColumnIndex
            };
            for (let r = m.startRowIndex; r < m.endRowIndex; r++) {
              for (let c = m.startColumnIndex; c < m.endColumnIndex; c++) {
                if (r !== m.startRowIndex || c !== m.startColumnIndex) {
                  skip.add(`${r},${c}`);
                }
              }
            }
          }

          let html = "<table><tbody>";
          rows.forEach((row, ri) => {
            html += "<tr>";
            var cells = row.values || [];
            cells.forEach((cell, ci) => {
              var key = `${ri},${ci}`;
              if (skip.has(key)) return;

              var val = cell?.effectiveValue;
              var text = val?.stringValue ?? val?.numberValue ?? val?.boolValue ?? "";

              var effectiveFmt = cell?.effectiveFormat ?? {};
              var userFmt = cell?.userEnteredFormat ?? {};
              var bg = toRGB(userFmt.backgroundColor, "#ffffff");
              var fg = toRGB(effectiveFmt.textFormat?.foregroundColor, "#000000");

              var isBold = effectiveFmt.textFormat?.bold === true || userFmt.textFormat?.bold === true;
              var rawSize = effectiveFmt.textFormat?.fontSize;
              var fontSize = rawSize > 10 ? rawSize : "";

              var borders = userFmt.borders || {};
              var borderTop = toBorderColor(borders.top);
              var borderBottom = toBorderColor(borders.bottom);
              var borderLeft = toBorderColor(borders.left);
              var borderRight = toBorderColor(borders.right);

              let borderStyle = "";
              if (borderTop) borderStyle += `border-top: 1px solid ${borderTop};`;
              if (borderBottom) borderStyle += `border-bottom: 1px solid ${borderBottom};`;
              if (borderLeft) borderStyle += `border-left: 1px solid ${borderLeft};`;
              if (borderRight) borderStyle += `border-right: 1px solid ${borderRight};`;

              var span = mergeMap[key];
              var tag = `<td style="background:${bg}; color:${fg}; font-weight:${isBold ? "bold" : "normal"}; font-size:${fontSize}px; ${borderStyle}"` +
                (span?.rowspan ? ` rowspan="${span.rowspan}"` : "") +
                (span?.colspan ? ` colspan="${span.colspan}"` : "") +
                `>${text}</td>`;
              html += tag;
            });
            html += "</tr>";
          });
          html += "</tbody></table>";

          document.getElementById("sheet-table").innerHTML = html;
        } catch (err) {
          console.error("ë¡œë”© ì˜¤ë¥˜:", err);
          document.getElementById("sheet-table").innerText = "âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
        }
      }

      loadData();
    };
    window.TransferInit();
  })();
</script>
