<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì˜ì£¼ë³´ì„ ê³„ì‚°ê¸°</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .muted{color:#6b7280}
    .pill{padding:.35rem .6rem;border:1px solid #d1d5db;border-radius:.75rem;background:#fff;color:#111827}
    .inline-label{display:flex;align-items:center;gap:.5rem}
    .tabular-nums{font-variant-numeric: tabular-nums}
    select.pill{height:32px}
    .err{color:#b45309}
    /* âœ… ë‹¤í¬ëª¨ë“œ */
    body.dark-mode{background-color:#121212;color:#f0f0f0}
    .dark-mode .border{border-color:#444!important}
    .dark-mode .bg-white{background-color:#2c2c2c!important;color:#f0f0f0!important}
    .dark-mode .bg-gray-100{background-color:#1e1e1e!important}
    .dark-mode .text-gray-800,.dark-mode .text-gray-700,.dark-mode .text-gray-600{color:#dddddd!important}
    .dark-mode .bg-purple-50,.dark-mode .bg-orange-50,.dark-mode .bg-red-50{background-color:#2e2e2e!important}
    .dark-mode select option{color:#000!important}
    .dark-mode select{color:#000!important}
    .dark-mode input{color:#000!important}

    /* helios ìŠ¤íƒ€ì¼ ê°ì„±ì˜ í•©ê³„ ì¹´ë“œ */
    .sum-card{border:1px solid rgba(0,0,0,.08); border-radius: .75rem; background: #fff; box-shadow: 0 6px 18px rgba(16,24,40,.08)}
    .sum-title{font-weight:700}
    .sum-item{display:flex; align-items:center; justify-content:space-between}
    .pill-badge{display:inline-block; border-radius:9999px; padding:.1rem .5rem; font-size:12px; border:1px solid rgba(0,0,0,.08)}
    .badge-total{background:#f3e8ff}   /* ë³´ë¼ */
    .badge-own{background:#fff7ed}     /* ì˜¤ë Œì§€ */
    .badge-def{background:#fee2e2}     /* ë ˆë“œ */
  </style>
  <script>
    // ë‹¤í¬ëª¨ë“œ ìœ ì§€
    window.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
      }
    });
  </script>
</head>
<body class="bg-gray-100 p-3 font-sans text-sm">
  <div class="max-w-[1500px] mx-auto bg-white p-2 rounded-xl shadow-md">
    <header class="flex items-center justify-between">
      <div class="p-4">
        <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight text-gray-800">ğŸ’ ì˜ì£¼ë³´ì„ ê³„ì‚°ê¸°</h1>
        <p class="text-sm muted mt-1">ë³´ì„ ì—…ê·¸ë ˆì´ë“œì— í•„ìš”í•œ <b>ë§¤ë‰´ì–¼ / ë„ë©´ / ë¹„ì „</b> í•©ê³„ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
      </div>
    </header>

    <!-- ì¹´ë“œ ê·¸ë¦¬ë“œ -->
    <section id="GemGrid" class="grid grid-cols-1 md:grid-cols-3 xl:grid-cols-3 gap-4"></section>

    <!-- ë³´ìœ  ìì› 
    <section class="mt-4 rounded-xl border border-black/10 bg-white px-4 py-3 shadow-lg">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-[15px] font-semibold text-gray-800">ë³´ìœ  ìì›</h3>
        <span class="muted">ì…ë ¥ ì‹œ ìë™ ê³„ì‚°</span>
      </div>
      <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
        <div>
          <label class="block font-semibold">ë³´ìœ  ë§¤ë‰´ì–¼</label>
          <input type="number" id="own-ë§¤ë‰´ì–¼" class="w-full border rounded p-2" placeholder="0" min="0"/>
        </div>
        <div>
          <label class="block font-semibold">ë³´ìœ  ë„ë©´</label>
          <input type="number" id="own-ë„ë©´" class="w-full border rounded p-2" placeholder="0" min="0"/>
        </div>
        <div>
          <label class="block font-semibold">ë³´ìœ  ë¹„ì „</label>
          <input type="number" id="own-ë¹„ì „" class="w-full border rounded p-2" placeholder="0" min="0"/>
        </div>
      </div>
    </section>
    -->

    <!-- í•©ê³„ íŒ¨ë„ (helios ëŠë‚Œ) 
    <section id="summaryPanel" class="mt-4 grid md:grid-cols-3 gap-4">
      <!-- JSì—ì„œ ì±„ì›€ 
    </section>
    -->
    <!-- í•˜ë‹¨ ì´í•© íŒ¨ë„ -->
    <div id="summaryPanel" class="exp-card mt-4">
      <div class="p-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
          <!-- ì´í•© -->
          <div class="rounded-xl border border-black/10 p-3">
            <div class="font-semibold mb-2">ì´í•©</div>
            <div class="flex justify-between text-[13px]">
              <span class="text-gray-600">ë§¤ë‰´ì–¼</span><span id="sum-ë§¤ë‰´ì–¼">0</span>
            </div>
            <div class="flex justify-between text-[13px] mt-1">
              <span class="text-gray-600">ë„ë©´</span><span id="sum-ë„ë©´">0</span>
            </div>
            <div class="flex justify-between text-[13px] mt-1">
              <span class="text-gray-600">ë¹„ì „</span><span id="sum-ë¹„ì „">0</span>
            </div>
          </div>
    
          <!-- ë³´ìœ  ìì› (í•©ê³„ íŒ¨ë„ ì•ˆì—ì„œ ì§ì ‘ ì…ë ¥) -->
          <div class="rounded-xl border border-black/10 p-3">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-[15px] font-semibold text-gray-800">ë³´ìœ  ìì›</h3>
              <span class="muted">ì…ë ¥ ì‹œ ìë™ ë°˜ì˜</span>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
              <div>
                <label class="block text-[12px] text-gray-600 mb-1">ë³´ìœ  ë§¤ë‰´ì–¼</label>
                <input type="number" id="own-ë§¤ë‰´ì–¼" class="w-full border rounded-lg px-3 py-2 text-sm" placeholder="0" min="0" inputmode="numeric"/>
              </div>
              <div>
                <label class="block text-[12px] text-gray-600 mb-1">ë³´ìœ  ë„ë©´</label>
                <input type="number" id="own-ë„ë©´" class="w-full border rounded-lg px-3 py-2 text-sm" placeholder="0" min="0" inputmode="numeric"/>
              </div>
              <div>
                <label class="block text-[12px] text-gray-600 mb-1">ë³´ìœ  ë¹„ì „</label>
                <input type="number" id="own-ë¹„ì „" class="w-full border rounded-lg px-3 py-2 text-sm" placeholder="0" min="0" inputmode="numeric"/>
              </div>
            </div>
          </div>
    
          <!-- ê³¼ë¶€ì¡± -->
          <div class="rounded-xl border border-black/10 p-3">
            <div class="font-semibold mb-2">ê³¼ë¶€ì¡±</div>
            <div class="flex justify-between text-[13px]">
              <span class="text-gray-600">ë§¤ë‰´ì–¼</span><span id="def-ë§¤ë‰´ì–¼">0</span>
            </div>
            <div class="flex justify-between text-[13px] mt-1">
              <span class="text-gray-600">ë„ë©´</span><span id="def-ë„ë©´">0</span>
            </div>
            <div class="flex justify-between text-[13px] mt-1">
              <span class="text-gray-600">ë¹„ì „</span><span id="def-ë¹„ì „">0</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ====== ì„ë² ë“œ ë†’ì´ ë³´ê³  ======
    function sendHeightToParent() {
      const height = document.body.scrollHeight + 10;
      window.parent?.postMessage?.({ type: "FRAME_CHANGE", height }, "*");
    }
    window.addEventListener("load", () => setTimeout(sendHeightToParent, 100));

    // ====== ë°ì´í„° ì†ŒìŠ¤ ======
    // ìŠ¤í‚¤ë§ˆ ê°€ì •: "ë ˆë²¨,ë§¤ë‰´ì–¼,ë„ë©´,ë¹„ì „" or "Lv.X, manual, blue, vision"
    // ê°’ì€ 'í•´ë‹¹(ëª©í‘œ) ë ˆë²¨ë¡œ ì˜¬ë¦´ ë•Œì˜ êµ¬ê°„ ë¹„ìš©'ì´ ê¸°ë³¸ (ì˜ˆ: 15â†’16 ì‹œ 16í–‰ ê°’ ì‚¬ìš©)
    const csvUrl = "https://raw.githubusercontent.com/s574shinchan/WOS_Calc/main/data/chief/Gem.csv";

    // ìŠ¬ë¡¯ ë¼ë²¨ (ì˜ˆì‹œ)
    const gemSlots = [
      "ë°©íŒ¨A","ë°©íŒ¨B","ë°©íŒ¨C","ë°©íŒ¨D","ë°©íŒ¨E","ë°©íŒ¨F",
      "ì°½ë³‘A","ì°½ë³‘B","ì°½ë³‘C","ì°½ë³‘D","ì°½ë³‘E","ì°½ë³‘F",
      "ê¶ë³‘A","ê¶ë³‘B","ê¶ë³‘C","ê¶ë³‘D","ê¶ë³‘E","ê¶ë³‘F",
    ];

    // ====== ìƒíƒœ ======
    let gemLevels = []; // ì •ë ¬ëœ ë ˆë²¨ ë¦¬ìŠ¤íŠ¸ (ì˜ˆ: [1,2,3,...,16,...])
    let levelToIdx = new Map(); // ë ˆë²¨ ìˆ«ì â†’ ìŠ¤í… ì¸ë±ìŠ¤
    window.__gemStepM = [];
    window.__gemStepB = [];
    window.__gemStepV = [];

    // ====== ìœ í‹¸ ======
    const fmt = (n) => Number(n || 0).toLocaleString("ko-KR");
    const detectDelim = (sample) => (sample.includes("\t") ? "\t" : (sample.includes(";") ? ";" : ","));
    const toNum = (s) => { const m = String(s||"").match(/-?\d+(\.\d+)?/); return m ? Number(m[0]) : 0; };
    const toInt = (s) => { const m = String(s||"").match(/\d+/); return m ? parseInt(m[0],10) : NaN; };

    function preprocessByLevel(text){
      let s = text.replace(/\uFEFF/g,"").replace(/\r/g,"");
      if (!s.includes("\n") && /Lv\.?\s*\d+/i.test(s)) {
        s = s.replace(/(Lv\.?\s*\d+)/gi, "\n$1");
      }
      return s;
    }

    // ====== CSV íŒŒì„œ (ê¸°ë³¸: êµ¬ê°„ë¹„ìš©, í—¤ë”ì— 'ëˆ„ì /í•©ê³„/total/cumulative' ìˆìœ¼ë©´ ëˆ„ì  í•´ì„ í›„ ì°¨ë¶„) ======
    function parseGemCSV(text){
      const pre = preprocessByLevel(text);
      const lines = pre.split("\n").filter(l => l.trim() !== "");
      if (!lines.length) return { levels:[], manual:[], blue:[], vision:[] };

      const delim = detectDelim(lines[0]);
      const hasHeader = /(ë ˆë²¨|lv|level|ë§¤ë‰´ì–¼|ë„ë©´|ë¹„ì „|manual|blue|vision|í•©ê³„|ëˆ„ì |total|cumulative)/i.test(lines[0]);
      const start = hasHeader ? 1 : 0;
      const headerLine = hasHeader ? lines[0] : "";
      const markCumulative = /(ëˆ„ì |í•©ê³„|total|cumulative)/i.test(headerLine);

      const M = new Map(), B = new Map(), V = new Map();
      const rawLevels = [];
      for (let i=start;i<lines.length;i++){
        const c = lines[i].split(delim);
        if (!c.length) continue;

        let lv, m, b, v;
        if (c.length >= 4){
          lv = toInt(c[0]); m = toNum(c[1]); b = toNum(c[2]); v = toNum(c[3]);
        }else{
          // ë ˆë²¨ì´ ìƒëµëœ 3ì—´ CSVì¼ ê²½ìš° 1ë¶€í„° ìˆœë²ˆìœ¼ë¡œ ê°€ì •
          lv = (i - start) + 1;
          m = toNum(c[0]); b = toNum(c[1]); v = toNum(c[2] || 0);
        }
        if (!Number.isFinite(lv)) continue;

        rawLevels.push(lv);
        M.set(lv, m); B.set(lv, b); V.set(lv, v);
      }

      const levels = [...new Set(rawLevels)].sort((a,b)=>a-b);
      if (levels.length < 2) return { levels, manual:[], blue:[], vision:[] };

      // ìŠ¤í… ë°°ì—´ ë§Œë“¤ê¸°
      // ië²ˆì§¸ ìŠ¤í…ì€ "levels[i] â†’ levels[i+1]" ì—…ê·¸ë ˆì´ë“œ ë¹„ìš©
      // ê¸°ë³¸(êµ¬ê°„): step[i] = ê°’(levels[i+1])  â†’ ì¦‰, 15â†’16 ìŠ¤í…ì€ 'Lv.16'ì˜ ê°’
      const stepM=[], stepB=[], stepV=[];
      for (let i=0;i<levels.length-1;i++){
        const a = levels[i], b = levels[i+1];
        if (markCumulative) {
          stepM[i] = Math.max(0, (M.get(b)||0) - (M.get(a)||0));
          stepB[i] = Math.max(0, (B.get(b)||0) - (B.get(a)||0));
          stepV[i] = Math.max(0, (V.get(b)||0) - (V.get(a)||0));
        } else {
          stepM[i] = Math.max(0, (M.get(b)||0));
          stepB[i] = Math.max(0, (B.get(b)||0));
          stepV[i] = Math.max(0, (V.get(b)||0));
        }
      }

      return { levels, manual:stepM, blue:stepB, vision:stepV };
    }

    function renderOptions(selectEl, levels){
      const label = (lv)=>`Lv.${lv}`;
      const opts = ['<option value=""></option>'].concat(
        levels.map(lv => `<option value="${lv}">${label(lv)}</option>`)
      ).join("");
      selectEl.innerHTML = opts;
    }
    function renderTargetOptions(selectEl, levels, greaterThan){
      const label = (lv)=>`Lv.${lv}`;
      const filtered = levels.filter(lv => lv > greaterThan);
      const opts = ['<option value=""></option>'].concat(
        filtered.map(lv => `<option value="${lv}">${label(lv)}</option>`)
      ).join("");
      selectEl.innerHTML = opts;
    }

    // ====== ì¹´ë“œ UI ìƒì„± (í˜„ì¬/ëª©í‘œ ì„¸ë¡œ ë°°ì¹˜) ======
    function createGemCards(){
      const grid = document.getElementById("GemGrid");
      grid.innerHTML = "";
      gemSlots.forEach((name, i) => {
        const card = document.createElement("div");
        card.className = "rounded-xl border border-black/10 bg-white px-4 py-3 shadow-lg";

        card.innerHTML = `
          <div class="flex items-center justify-between mb-2">
            <label class="text-base font-bold flex items-center gap-2">
              <span>${name}</span>
            </label>
            <span id="warn-${i}" class="text-xs err"></span>
          </div>

          <div class="grid md:grid-cols-2 gap-3">
            <div>
              <div class="text-sm font-semibold mb-2">ë ˆë²¨ ë²”ìœ„ <span id="cap-${i}" class="muted"></span></div>
              <div class="space-y-2">
                <label class="inline-label w-full justify-between">
                  <span class="muted w-14">í˜„ì¬</span>
                  <select id="cur-${i}" class="pill w-28"></select>
                </label>
                <label class="inline-label w-full justify-between">
                  <span class="muted w-14">ëª©í‘œ</span>
                  <select id="tgt-${i}" class="pill w-28"></select>
                </label>
              </div>
            </div>
            <div class="md:pl-2">
              <div class="font-semibold text-gray-800 mb-2">í•„ìš” í•©ê³„</div>
              <div class="grid grid-cols-[1fr_auto] gap-x-3 text-[13px]">
                <div class="text-gray-600">ë§¤ë‰´ì–¼</div><div class="text-right tabular-nums" id="m-${i}">0</div>
                <div class="text-gray-600">ë„ë©´</div><div class="text-right tabular-nums" id="b-${i}">0</div>
                <div class="text-gray-600">ë¹„ì „</div><div class="text-right tabular-nums" id="v-${i}">0</div>
              </div>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // ====== ê³„ì‚° ======
    // fromLvâ†’toLv í•©: ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ (fromLv+1 ... toLv)ê¹Œì§€ í¬í•¨
    function sumRange(steps, fromLv, toLv){
      if (!Array.isArray(steps) || steps.length === 0) return 0;
      let s = 0;
      // lvëŠ” 'ì‹œì‘ ë ˆë²¨'ì´ ì•„ë‹ˆë¼ 'ëª©í‘œ ë ˆë²¨'ì„ 1ì”© ì¦ê°€ì‹œí‚¤ë©° í•©ì‚°:
      // ìš°ë¦¬ê°€ ë§Œë“  steps[idx]ëŠ” 'levels[idx]â†’levels[idx+1]' ìŠ¤í…ì´ë©° ê°’ì€ levels[idx+1](=ëª©í‘œ ë ˆë²¨)ì˜ ë¹„ìš©
      // ë”°ë¼ì„œ lvë¥¼ fromLvë¶€í„° toLv-1ê¹Œì§€ ëŒë¦¬ë©´ì„œ idxë¥¼ ë§¤í•‘í•˜ë©´
      // ì‹¤ì œ í•©ì‚°ë˜ëŠ” ë¹„ìš©ì€ (fromLv+1 ... toLv)ì˜ ê°’ì´ ë¨
      for (let lv = fromLv; lv < toLv; lv++) {
        const idx = levelToIdx.get(lv); // lvâ†’(lv+1) ìŠ¤í…ì˜ ì¸ë±ìŠ¤
        if (idx !== undefined && idx >= 0 && idx < steps.length) {
          s += steps[idx] || 0;
        }
      }
      return s;
    }
    
    function calculate(){
      const total = { m:0, b:0, v:0 };
      for (let i=0;i<gemSlots.length;i++){
        const warn = document.getElementById(`warn-${i}`);
        const curEl= document.getElementById(`cur-${i}`);
        const tgtEl= document.getElementById(`tgt-${i}`);
        const outM = document.getElementById(`m-${i}`);
        const outB = document.getElementById(`b-${i}`);
        const outV = document.getElementById(`v-${i}`);

        outM.textContent = outB.textContent = outV.textContent = "0";
        warn.textContent = "";

        const cur = +curEl.value;
        const tgt = +tgtEl.value;

        if (cur && tgt) {
          if (tgt <= cur) {
            warn.textContent = "ëª©í‘œëŠ” í˜„ì¬ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.";
            continue;
          } else {
            warn.textContent = "";
          }
        } else {
          // í•˜ë‚˜ë¼ë„ ë¹„ì–´ ìˆìœ¼ë©´ ë¬¸êµ¬ í‘œì‹œ ì•ˆ í•¨ (í•„ìš”í•©ê³„ë„ 0 ìœ ì§€)
          warn.textContent = "";
          continue;
        }

        // ìš”êµ¬ì‚¬í•­: cur=1,tgt=16 â†’ Lv.2~16 í•© / cur=15,tgt=16 â†’ Lv.16ë§Œ
        const sM = sumRange(window.__gemStepM, cur, tgt);
        const sB = sumRange(window.__gemStepB, cur, tgt);
        const sV = sumRange(window.__gemStepV, cur, tgt);

        total.m += sM; 
        total.b += sB; 
        total.v += sV;
        
        outM.textContent = fmt(sM);
        outB.textContent = fmt(sB);
        outV.textContent = fmt(sV);
      }

      const owned = {
        m: +(document.getElementById("own-ë§¤ë‰´ì–¼").value || 0),
        b: +(document.getElementById("own-ë„ë©´").value || 0),
        v: +(document.getElementById("own-ë¹„ì „").value || 0),
      };
      const def = { m: owned.m - total.m, b: owned.b - total.b, v: owned.v - total.v };

      const sM = document.getElementById("sum-ë§¤ë‰´ì–¼");
      const sB = document.getElementById("sum-ë„ë©´");
      const sV = document.getElementById("sum-ë¹„ì „");
      const dM = document.getElementById("def-ë§¤ë‰´ì–¼");
      const dB = document.getElementById("def-ë„ë©´");
      const dV = document.getElementById("def-ë¹„ì „");
  
      if (sM) sM.textContent = fmt(total.m);
      if (sB) sB.textContent = fmt(total.b);
      if (sV) sV.textContent = fmt(total.v);
      if (dM) dM.textContent = fmt(def.m);
      if (dB) dB.textContent = fmt(def.b);
      if (dV) dV.textContent = fmt(def.v);

      dM.classList.toggle("text-red-600", parseFloat(dM.textContent.replace(/,/g,'')) < 0);
      dB.classList.toggle("text-red-600", parseFloat(dB.textContent.replace(/,/g,'')) < 0);
      dV.classList.toggle("text-red-600", parseFloat(dV.textContent.replace(/,/g,'')) < 0);
      
      sendHeightToParent();
    }

    // ====== ì´ë²¤íŠ¸ ======
    function wireEvents(){
      for (let i=0;i<gemSlots.length;i++){
        const curEl= document.getElementById(`cur-${i}`);
        const tgtEl= document.getElementById(`tgt-${i}`);
        // í˜„ì¬ â†’ ëª©í‘œ ìë™ (cur+1)
        curEl.addEventListener("change", () => {
          const cur = +curEl.value;
          if (!cur){
            tgtEl.innerHTML = '<option value=""></option>';
          }else{
            renderTargetOptions(tgtEl, gemLevels, cur);
            if (tgtEl.options.length > 1) tgtEl.selectedIndex = 1; // ê¸°ë³¸ cur+1
          }
          calculate();
        });
        tgtEl.addEventListener("change", calculate);
      }
      ["own-ë§¤ë‰´ì–¼","own-ë„ë©´","own-ë¹„ì „"].forEach(id => {
        document.getElementById(id).addEventListener("input", calculate);
      });
    }

    // ====== ë¡œë“œ ======
    async function fetchCSVData(){
      try{
        const res = await fetch(csvUrl, { cache: "no-store", mode: "cors", redirect:"follow", referrerPolicy:"no-referrer" });
        if (!res.ok) throw new Error("HTTP " + res.status);
        const text = await res.text();

        const { levels, manual, blue, vision } = parseGemCSV(text);
        gemLevels = levels;
        window.__gemStepM = manual;
        window.__gemStepB = blue;
        window.__gemStepV = vision;

        // ë ˆë²¨ â†’ ìŠ¤í… ì¸ë±ìŠ¤ ë§µ (lvâ†’lv+1 ìŠ¤í…ì˜ ì¸ë±ìŠ¤)
        levelToIdx = new Map(gemLevels.map((lv, i) => [lv, i]));

        // UI ìƒì„± + ì˜µì…˜ ì±„ìš°ê¸°
        createGemCards();
        for (let i=0;i<gemSlots.length;i++){
          const curEl = document.getElementById(`cur-${i}`);
          const tgtEl = document.getElementById(`tgt-${i}`);
          const capEl = document.getElementById(`cap-${i}`);
          renderOptions(curEl, gemLevels);
          tgtEl.innerHTML = '<option value=""></option>'; // í˜„ì¬ ì„ íƒ í›„ ëª©í‘œ êµ¬ì„±
          capEl.textContent = gemLevels.length ? `(ìµœëŒ€ Lv.${gemLevels[gemLevels.length-1]})` : "";
        }

        wireEvents();
        calculate();
      }catch(err){
        console.error("CSV ë¡œë“œ ì‹¤íŒ¨:", err);
        document.getElementById("GemGrid").innerHTML =
          '<div class="rounded-xl border border-black/10 bg-white px-4 py-3 shadow-lg text-sm err">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. CSV ê²½ë¡œë¥¼ í™•ì¸í•˜ì„¸ìš”.</div>';
      }finally{
        sendHeightToParent();
      }
    }

    fetchCSVData();
  </script>

  <!-- ì„ íƒ: ê°œë°œìë„êµ¬/ìš°í´ë¦­ ë°©ì§€ (ì› ì½”ë“œ ìœ ì§€) -->
  <script>
    document.onkeydown = function (e) {
      if (
        e.keyCode === 123 || // F12
        (e.ctrlKey && e.shiftKey && e.keyCode === 73) || // Ctrl+Shift+I
        (e.ctrlKey && e.shiftKey && e.keyCode === 74) || // Ctrl+Shift+J
        (e.ctrlKey && e.keyCode === 85) // Ctrl+U
      ) {
        e.preventDefault();
        return false;
      }
    };
    document.addEventListener("contextmenu", (e) => e.preventDefault());
  </script>
  <script>
    window.addEventListener('message', (e) => {
      if (e.data?.type === 'DARK_MODE') {
        document.body.classList.toggle('dark-mode', e.data.value);
      }
    });
  </script>  
</body>
</html>
