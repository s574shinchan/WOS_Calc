<meta charset="UTF-8" />
<div class="card transfer-card">
  <h2 class="transfer-title">ğŸŒ ì´ë¯¼ê·¸ë£¹ (2025)</h2>
  <div id="sheet-table-2025" class="transfer-loading">
    â³ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
  </div>
</div>

<script>
(function(){

  async function loadData(){
    try{
      const response = await fetch(
        "https://wos-transfer-history2025.mko75620.workers.dev/get-sheet"
      );
      if(!response.ok) throw new Error("í”„ë¡ì‹œ í˜¸ì¶œ ì‹¤íŒ¨");

      const data = await response.json();
      const sheet = data.sheets[0];
      const rows = sheet.data[0].rowData || [];

      let html = "<table class='transfer-table'><tbody>";

      rows.forEach(row=>{
        html += "<tr>";
        (row.values||[]).forEach(cell=>{
          const val = cell?.effectiveValue;
          const text = val?.stringValue ?? val?.numberValue ?? "";
          html += `<td>${text}</td>`;
        });
        html += "</tr>";
      });

      html += "</tbody></table>";

      document.getElementById("sheet-table-2025").innerHTML = html;

    }catch(e){
      document.getElementById("sheet-table-2025").innerText =
        "âŒ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
    }
  }

  loadData();

})();
</script>
